(()=>{"use strict";var e={9501:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.assert=void 0;const n=t(514);o.assert=function(e,o){if(!e)throw new n.AssertionError(o)}},514:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AssertionError=void 0;const n=t(108);class r extends n.CustomError{}o.AssertionError=r},108:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CustomError=void 0;class t extends Error{get name(){return this.constructor.name}}o.CustomError=t},9128:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ExpectedError=void 0;const n=t(108);class r extends n.CustomError{}o.ExpectedError=r},3271:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||n(o,e,t)};Object.defineProperty(o,"__esModule",{value:!0}),r(t(108),o),r(t(9128),o),r(t(514),o),r(t(5887),o),r(t(4843),o),r(t(9501),o)},5887:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.normalize=void 0,o.normalize=function(e){var o;return{name:e.name,message:e.message,stack:null!==(o=e.stack)&&void 0!==o?o:null}}},4843:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.refute=void 0;const n=t(9128);o.refute=function(e,o){if(e)throw new n.ExpectedError(o)}},1421:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.go=void 0,o.go=function(e){return e()}},6065:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||n(o,e,t)};Object.defineProperty(o,"__esModule",{value:!0}),r(t(1421),o)},8762:(e,o)=>{function t(e){return Array.isArray(e)}Object.defineProperty(o,"__esModule",{value:!0}),o.isntEmptyArray=o.isEmptyArray=o.isntArray=o.isArray=void 0,o.isArray=t,o.isntArray=function(e){return!t(e)},o.isEmptyArray=function(e){return 0===e.length},o.isntEmptyArray=function(e){return 0!==e.length}},2336:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isntAsyncIterable=o.isAsyncIterable=void 0;const n=t(3758),r=t(5448);function i(e){return(0,n.isntNull)(e)&&(0,r.isntUndefined)(e)&&"function"==typeof e[Symbol.asyncIterator]}o.isAsyncIterable=i,o.isntAsyncIterable=function(e){return!i(e)}},4342:(e,o)=>{function t(e){return"bigint"==typeof e}Object.defineProperty(o,"__esModule",{value:!0}),o.isntBigInt=o.isBigInt=void 0,o.isBigInt=t,o.isntBigInt=function(e){return!t(e)}},3560:(e,o)=>{function t(e){return"boolean"==typeof e}Object.defineProperty(o,"__esModule",{value:!0}),o.isntBoolean=o.isBoolean=void 0,o.isBoolean=t,o.isntBoolean=function(e){return!t(e)}},5792:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isntChar=o.isChar=void 0;const n=t(6986);function r(e){return(0,n.isString)(e)&&1===e.length}o.isChar=r,o.isntChar=function(e){return!r(e)}},5655:(e,o)=>{function t(e){return e instanceof Date}Object.defineProperty(o,"__esModule",{value:!0}),o.isntDate=o.isDate=void 0,o.isDate=t,o.isntDate=function(e){return!t(e)}},3245:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.inEnum=void 0,o.inEnum=function(e,o){return Object.values(o).includes(e)}},4730:(e,o)=>{function t(e){return e instanceof Error}Object.defineProperty(o,"__esModule",{value:!0}),o.isntError=o.isError=void 0,o.isError=t,o.isntError=function(e){return!t(e)}},4716:(e,o)=>{function t(e){return!e}Object.defineProperty(o,"__esModule",{value:!0}),o.isntFalsy=o.isFalsy=void 0,o.isFalsy=t,o.isntFalsy=function(e){return!t(e)}},3345:(e,o)=>{function t(e){return"function"==typeof e}Object.defineProperty(o,"__esModule",{value:!0}),o.isntFunction=o.isFunction=void 0,o.isFunction=t,o.isntFunction=function(e){return!t(e)}},4510:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||n(o,e,t)};Object.defineProperty(o,"__esModule",{value:!0}),r(t(8762),o),r(t(2336),o),r(t(4342),o),r(t(3560),o),r(t(5792),o),r(t(5655),o),r(t(3245),o),r(t(4730),o),r(t(4716),o),r(t(3345),o),r(t(8969),o),r(t(3954),o),r(t(9756),o),r(t(3758),o),r(t(3011),o),r(t(5408),o),r(t(6986),o),r(t(5448),o),r(t(5377),o)},8969:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isntIterable=o.isIterable=void 0;const n=t(3758),r=t(5448);function i(e){return(0,n.isntNull)(e)&&(0,r.isntUndefined)(e)&&"function"==typeof e[Symbol.iterator]}o.isIterable=i,o.isntIterable=function(e){return!i(e)}},3954:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isntJsonRpcError=o.isJsonRpcError=o.isntJsonRpcSuccess=o.isJsonRpcSuccess=o.isntJsonRpcRequest=o.isJsonRpcRequest=o.isntJsonRpcNotification=o.isJsonRpcNotification=void 0;const n=t(8762),r=t(5408),i=t(6986),a=t(3011),s=t(5448);function l(e){return(0,i.isString)(e)||(0,a.isNumber)(e)}function c(e){return(0,n.isArray)(e)||(0,r.isObject)(e)}function d(e){return(0,r.isRecord)(e)&&(0,i.isString)(e.jsonrpc)&&(0,i.isString)(e.method)&&(0,s.isUndefined)(e.id)&&c(e.params)}function u(e){return(0,r.isRecord)(e)&&(0,i.isString)(e.jsonrpc)&&(0,i.isString)(e.method)&&l(e.id)&&c(e.params)}function f(e){return(0,r.isRecord)(e)&&(0,i.isString)(e.jsonrpc)&&(0,i.isString)(e.id)&&"result"in e}function _(e){return(0,r.isRecord)(e)&&(0,i.isString)(e.jsonrpc)&&l(e.id)&&function(e){return(0,r.isRecord)(e)&&(0,a.isNumber)(e.code)&&(0,i.isString)(e.message)&&((0,s.isUndefined)(e.data)||(0,r.isObject)(e.data))}(e.error)}o.isJsonRpcNotification=d,o.isntJsonRpcNotification=function(e){return!d(e)},o.isJsonRpcRequest=u,o.isntJsonRpcRequest=function(e){return!u(e)},o.isJsonRpcSuccess=f,o.isntJsonRpcSuccess=function(e){return!f(e)},o.isJsonRpcError=_,o.isntJsonRpcError=function(e){return!_(e)}},9756:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isntJson=o.isJson=void 0,o.isJson=function(e){try{return JSON.stringify(e),!0}catch(e){return!1}},o.isntJson=function e(o){return!e(o)}},3758:(e,o)=>{function t(e){return null===e}Object.defineProperty(o,"__esModule",{value:!0}),o.isntNull=o.isNull=void 0,o.isNull=t,o.isntNull=function(e){return!t(e)}},3011:(e,o)=>{function t(e){return"number"==typeof e}Object.defineProperty(o,"__esModule",{value:!0}),o.isntNumber=o.isNumber=void 0,o.isNumber=t,o.isntNumber=function(e){return!t(e)}},5408:(e,o)=>{function t(e){return null!==e&&"object"==typeof e}Object.defineProperty(o,"__esModule",{value:!0}),o.isntEmptyObject=o.isEmptyObject=o.isRecord=o.isntObject=o.isObject=void 0,o.isObject=t,o.isntObject=function(e){return!t(e)},o.isRecord=function(e){return t(e)},o.isEmptyObject=function(e){return 0===Object.keys(e).length},o.isntEmptyObject=function(e){return 0!==Object.keys(e).length}},6986:(e,o)=>{function t(e){return"string"==typeof e}Object.defineProperty(o,"__esModule",{value:!0}),o.isntString=o.isString=void 0,o.isString=t,o.isntString=function(e){return!t(e)}},5448:(e,o)=>{function t(e){return void 0===e}Object.defineProperty(o,"__esModule",{value:!0}),o.isntUndefined=o.isUndefined=void 0,o.isUndefined=t,o.isntUndefined=function(e){return!t(e)}},5377:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isAbsoluteURL=void 0,o.isAbsoluteURL=function(e){try{return new URL(e),!0}catch(e){return!1}}},2122:function(e,o){var t=this&&this.__read||function(e,o){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,r,i=t.call(e),a=[];try{for(;(void 0===o||o-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return a},n=this&&this.__spread||function(){for(var e=[],o=0;o<arguments.length;o++)e=e.concat(t(arguments[o]));return e};function r(e){return 0===e["王"]["黒"]&&0===e["王"]["赤"]?function(e){function o(o){return e[o]["赤"]+e[o]["黒"]>0}function t(o){return e[o]["赤"]+e[o]["黒"]}var n=new Set;e["兵"]["赤"]>=5||e["兵"]["黒"]>=5?n.add("同色闇戦之集"):t("兵")>=5&&n.add("闇戦之集"),e["車"]["赤"]>=1&&e["兵"]["赤"]>=2||e["車"]["黒"]>=1&&e["兵"]["黒"]>=2?n.add("同色助友"):o("車")&&t("兵")>=2&&n.add("助友"),e["将"]["赤"]>=1&&e["兵"]["赤"]>=2||e["将"]["黒"]>=1&&e["兵"]["黒"]>=2?n.add("同色戦集"):o("将")&&t("兵")>=2&&n.add("戦集");var r=function(t,r,i){var a;(a=t).every((function(o){return e[o]["赤"]>=1}))||a.every((function(o){return e[o]["黒"]>=1}))?n.add(r):function(e){return e.every(o)}(t)&&n.add(i)};return r(["虎","馬"],"同色獣","獣"),r(["船","車","馬"],"同色行行","行行"),r(["兵","弓","馬"],"同色馬弓兵","馬弓兵"),r(["筆","巫","将"],"同色地心","地心"),r(["兵","弓","将","筆","巫"],"同色筆兵無傾","筆兵無傾"),n}(e):function(e){function o(o){return e[o]["赤"]+e[o]["黒"]>0}var t=new Set(["王"]);t.add("王");var i,a=["兵","弓","車","虎","馬","筆","巫","将","船"];(i=n(a,["王"])).every((function(o){return e[o]["赤"]>=1}))||i.every((function(o){return e[o]["黒"]>=1}))?t.add("同色無抗行処"):function(e){return e.every(o)}(n(a,["王"]))&&t.add("無抗行処");var s=function(o){if(1===e["王"][o]){e["王"][o]--;for(var i=0;i<a.length;i++)e[a[i]][o]++,t=new Set(n(t,r(e))),e[a[i]][o]--;e["王"][o]++}};s("赤"),s("黒");var l=function(e,o){t.has(e)&&t.delete(o)};return l("同色助友","助友"),l("同色地心","地心"),l("同色戦集","戦集"),l("同色馬弓兵","馬弓兵"),l("同色獣","獣"),l("同色行行","行行"),l("同色筆兵無傾","筆兵無傾"),l("同色闇戦之集","闇戦之集"),l("同色無抗行処","無抗行処"),t}(e)}Object.defineProperty(o,"__esModule",{value:!0}),o.generate_example=o.calculate_hands_and_score_from_pieces=o.hand_to_score=o.toObtainablePieces2=void 0,o.toObtainablePieces2={黒兵:{color:"黒",prof:"兵"},赤兵:{color:"赤",prof:"兵"},黒弓:{color:"黒",prof:"弓"},黒車:{color:"黒",prof:"車"},黒虎:{color:"黒",prof:"虎"},黒馬:{color:"黒",prof:"馬"},黒筆:{color:"黒",prof:"筆"},黒巫:{color:"黒",prof:"巫"},黒将:{color:"黒",prof:"将"},赤弓:{color:"赤",prof:"弓"},赤車:{color:"赤",prof:"車"},赤虎:{color:"赤",prof:"虎"},赤馬:{color:"赤",prof:"馬"},赤筆:{color:"赤",prof:"筆"},赤巫:{color:"赤",prof:"巫"},赤将:{color:"赤",prof:"将"},黒王:{color:"黒",prof:"王"},赤王:{color:"赤",prof:"王"},黒船:{color:"黒",prof:"船"},赤船:{color:"赤",prof:"船"}},o.hand_to_score={無抗行処:50,同色無抗行処:52,筆兵無傾:10,同色筆兵無傾:12,地心:7,同色地心:9,馬弓兵:5,同色馬弓兵:7,行行:5,同色行行:7,王:5,獣:3,同色獣:5,戦集:3,同色戦集:5,助友:3,同色助友:5,闇戦之集:3,同色闇戦之集:5,皇再来:-3,撃皇:-5},o.calculate_hands_and_score_from_pieces=function(e){var t=function(e){for(var t=e.map((function(e){return o.toObtainablePieces2[e]})),i={兵:{黒:0,赤:0},弓:{黒:0,赤:0},車:{黒:0,赤:0},虎:{黒:0,赤:0},馬:{黒:0,赤:0},筆:{黒:0,赤:0},巫:{黒:0,赤:0},将:{黒:0,赤:0},王:{黒:0,赤:0},船:{黒:0,赤:0}},a=0;a<t.length;a++)i[t[a].prof][t[a].color]++;var s=[];return i["兵"]["黒"]>8&&s.push("黒兵"),i["兵"]["赤"]>8&&s.push("赤兵"),i["弓"]["黒"]>2&&s.push("黒弓"),i["弓"]["赤"]>2&&s.push("赤弓"),i["車"]["黒"]>2&&s.push("黒車"),i["車"]["赤"]>2&&s.push("赤車"),i["虎"]["黒"]>2&&s.push("黒虎"),i["虎"]["赤"]>2&&s.push("赤虎"),i["馬"]["黒"]>2&&s.push("黒馬"),i["馬"]["赤"]>2&&s.push("赤馬"),i["筆"]["黒"]>2&&s.push("黒筆"),i["筆"]["赤"]>2&&s.push("赤筆"),i["巫"]["黒"]>2&&s.push("黒巫"),i["巫"]["赤"]>2&&s.push("赤巫"),i["将"]["黒"]>2&&s.push("黒将"),i["将"]["赤"]>2&&s.push("赤将"),i["王"]["黒"]>1&&s.push("黒王"),i["王"]["赤"]>1&&s.push("赤王"),i["船"]["黒"]>1&&s.push("黒船"),i["船"]["赤"]>1&&s.push("赤船"),s.length>0?{too_many:s}:n(r(i))}(e);return Array.isArray(t)?{error:!1,score:t.map((function(e){return o.hand_to_score[e]})).reduce((function(e,o){return e+o}),0),hands:t}:{error:!0,too_many:t.too_many}},o.generate_example=function(e){for(var o,n=["黒兵","黒兵","黒兵","黒兵","黒兵","黒兵","黒兵","黒兵","赤兵","赤兵","赤兵","赤兵","赤兵","赤兵","赤兵","赤兵","黒弓","黒車","黒虎","黒馬","黒筆","黒巫","黒将","黒弓","黒車","黒虎","黒馬","黒筆","黒巫","黒将","赤弓","赤車","赤虎","赤馬","赤筆","赤巫","赤将","赤弓","赤車","赤虎","赤馬","赤筆","赤巫","赤将","黒王","赤王","黒船","赤船"],r=n.length-1;r>0;r--){var i=Math.floor(Math.random()*(r+1));o=t([n[i],n[r]],2),n[r]=o[0],n[i]=o[1]}return n.slice(0,e)}},8431:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||n(o,e,t)};Object.defineProperty(o,"__esModule",{value:!0}),r(t(2122),o)},4974:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||n(o,e,t)};Object.defineProperty(o,"__esModule",{value:!0}),r(t(101),o),r(t(6453),o),r(t(5588),o)},5588:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0})},6453:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0})},101:(e,o)=>{var t,n;Object.defineProperty(o,"__esModule",{value:!0}),o.Profession=o.Color=void 0,(n=o.Color||(o.Color={}))[n.Kok1=0]="Kok1",n[n.Huok2=1]="Huok2",(t=o.Profession||(o.Profession={}))[t.Nuak1=0]="Nuak1",t[t.Kauk2=1]="Kauk2",t[t.Gua2=2]="Gua2",t[t.Kaun1=3]="Kaun1",t[t.Dau2=4]="Dau2",t[t.Maun1=5]="Maun1",t[t.Kua2=6]="Kua2",t[t.Tuk2=7]="Tuk2",t[t.Uai1=8]="Uai1",t[t.Io=9]="Io"},3945:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.calculateMovablePositions=o.canGetOccupiedByNonTam=o.canGetOccupiedBy=o.isTamHue=o.eightNeighborhood=void 0;const n=t(6233),r=t(4974);function i(e,o){const[t,n]=e;return o.map((([e,o])=>[t+e,n+o])).filter((([e,o])=>0<=e&&e<=8&&0<=o&&o<=8)).map((([e,o])=>[e,o]))}function a(e){const[o,t]=e,n=[];for(let e=-8;e<=8;e++)for(let r=-8;r<=8;r++)o*r-t*e==0&&(o*e+t*r<=0||e*e+r*r>=o*o+t*t||(n[n.length]=[e,r]));return n}function s(e,o,t){return[].concat(...o.map((o=>l(e,o,t))))}function l(e,o,t){return i(e,a(o)).every((([e,o])=>null==t[e][o]))?i(e,[o]):[]}function c(e,o,t){return[].concat(...o.map((o=>function(e,o,t){return i(e,a(o)).filter((([e,o])=>null!=t[e][o])).length<=1?i(e,[o]):[]}(e,o,t))))}function d(e){return i(e,[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]])}function u(e,o,t){return!!(n.coordEq(e,[2,2])||n.coordEq(e,[2,6])||n.coordEq(e,[3,3])||n.coordEq(e,[3,5])||n.coordEq(e,[4,4])||n.coordEq(e,[5,3])||n.coordEq(e,[5,5])||n.coordEq(e,[6,2])||n.coordEq(e,[6,6]))||!(!t||"Tam2"!==o[e[0]][e[1]])||d(e).some((([e,t])=>"Tam2"===o[e][t]))}function f(e,o,t,n){const[i,a]=o,s=t[i][a];return"Tam2"!==s&&(null===s||s.side!==e&&!((e,o)=>d(o).filter((([o,i])=>{const a=t[o][i];return null!=a&&"Tam2"!==a&&a.prof===r.Profession.Uai1&&a.side!==e&&u([o,i],t,n)})).length>0)(e,o))}console.assert("[[-4,2],[-2,1]]"===JSON.stringify(a([-6,3]))),console.assert("[[-2,0],[-1,0]]"===JSON.stringify(a([-3,0]))),console.assert("[[0,1],[0,2]]"===JSON.stringify(a([0,3]))),o.eightNeighborhood=d,o.isTamHue=u,o.canGetOccupiedBy=function(e,o,t,n,r){if("Tam2"===t){const[e,t]=o;return null===n[e][t]}return f(e,o,n,r)},o.canGetOccupiedByNonTam=f,o.calculateMovablePositions=function(e,o,t,n){if("Tam2"===o)return{finite:d(e),infinite:[]};if(o.prof===r.Profession.Io)return{finite:d(e),infinite:[]};const f=[[-8,-8],[-7,-7],[-6,-6],[-5,-5],[-4,-4],[-3,-3],[-2,-2],[-1,-1]],_=[[-8,8],[-7,7],[-6,6],[-5,5],[-4,4],[-3,3],[-2,2],[-1,1]],p=[[8,-8],[7,-7],[6,-6],[5,-5],[4,-4],[3,-3],[2,-2],[1,-1]],m=[[8,8],[7,7],[6,6],[5,5],[4,4],[3,3],[2,2],[1,1]],y=[[-1,0],[-2,0],[-3,0],[-4,0],[-5,0],[-6,0],[-7,0],[-8,0]],E=[[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0]],w=[[0,-1],[0,-2],[0,-3],[0,-4],[0,-5],[0,-6],[0,-7],[0,-8]],v=[[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8]];if(u(e,t,n))switch(o.prof){case r.Profession.Uai1:return{finite:d(e),infinite:[]};case r.Profession.Kaun1:return{finite:i(e,[[-2,-2],[-2,2],[2,2],[2,-2]]),infinite:[]};case r.Profession.Kauk2:return{finite:[...i(e,[[-1,0],[0,-1],[0,1],[1,0]]),...l(e,[-2,0],t)],infinite:[]};case r.Profession.Nuak1:return{finite:[...i(e,[[0,-1],[0,1]]),...s(e,[[0,-2],[0,2]],t)],infinite:s(e,[...y,...E],t)};case r.Profession.Gua2:case r.Profession.Dau2:return{finite:[],infinite:s(e,[...f,..._,...p,...m],t)};case r.Profession.Maun1:{const o=[[-8,-8],[-7,-7],[-6,-6],[-5,-5],[-4,-4],[-3,-3],[-2,-2],[-8,8],[-7,7],[-6,6],[-5,5],[-4,4],[-3,3],[-2,2],[8,-8],[7,-7],[6,-6],[5,-5],[4,-4],[3,-3],[2,-2],[8,8],[7,7],[6,6],[5,5],[4,4],[3,3],[2,2]];let n=[];for(let r=0;r<o.length;r++){const s=o[r];i(e,a(s).filter((e=>!([-1,1].includes(e[0])&&[-1,1].includes(e[1]))))).every((([e,o])=>null==t[e][o]))&&(n=[...n,...i(e,[s])])}return{finite:[],infinite:n}}case r.Profession.Kua2:return{finite:[],infinite:s(e,[...y,...E,...w,...v],t)};case r.Profession.Tuk2:return{finite:[],infinite:c(e,[...y,...E,...w,...v,...f,..._,...p,...m],t)};default:return o.prof}else switch(o.prof){case r.Profession.Kauk2:return{finite:i(e,[[-1,0]]),infinite:[]};case r.Profession.Kaun1:return{finite:i(e,[[-2,0],[2,0],[0,-2],[0,2]]),infinite:[]};case r.Profession.Dau2:return{finite:i(e,[[-1,-1],[-1,1],[1,-1],[1,1]]),infinite:[]};case r.Profession.Maun1:return{finite:i(e,[[-2,-2],[-2,2],[2,2],[2,-2]]),infinite:[]};case r.Profession.Nuak1:return{finite:[],infinite:s(e,y,t)};case r.Profession.Gua2:return{finite:[],infinite:s(e,[...y,...E,...w,...v],t)};case r.Profession.Kua2:return{finite:i(e,[[0,-1],[0,1]]),infinite:s(e,[...y,...E],t)};case r.Profession.Tuk2:return{finite:i(e,[[-1,0],[1,0]]),infinite:s(e,[...w,...v],t)};case r.Profession.Uai1:return{finite:i(e,[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,1]]),infinite:[]};default:return o.prof}}},3247:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.initial_board_with_IA_down=void 0;const n=t(6233),r=t(4974);o.initial_board_with_IA_down=[[{color:r.Color.Huok2,prof:r.Profession.Kua2,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Maun1,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Kaun1,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Uai1,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Io,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Uai1,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kaun1,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Maun1,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kua2,side:n.Side.Downward}],[{color:r.Color.Kok1,prof:r.Profession.Tuk2,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Gua2,side:n.Side.Downward},null,{color:r.Color.Kok1,prof:r.Profession.Dau2,side:n.Side.Downward},null,{color:r.Color.Huok2,prof:r.Profession.Dau2,side:n.Side.Downward},null,{color:r.Color.Huok2,prof:r.Profession.Gua2,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Tuk2,side:n.Side.Downward}],[{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Nuak1,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Downward}],[null,null,null,null,null,null,null,null,null],[null,null,null,null,"Tam2",null,null,null,null],[null,null,null,null,null,null,null,null,null],[{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Nuak1,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Upward}],[{color:r.Color.Huok2,prof:r.Profession.Tuk2,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Gua2,side:n.Side.Upward},null,{color:r.Color.Huok2,prof:r.Profession.Dau2,side:n.Side.Upward},null,{color:r.Color.Kok1,prof:r.Profession.Dau2,side:n.Side.Upward},null,{color:r.Color.Kok1,prof:r.Profession.Gua2,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Tuk2,side:n.Side.Upward}],[{color:r.Color.Kok1,prof:r.Profession.Kua2,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Maun1,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Kaun1,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Uai1,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Io,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Uai1,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Kaun1,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Maun1,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Kua2,side:n.Side.Upward}]]},892:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||n(o,e,t)};Object.defineProperty(o,"__esModule",{value:!0}),r(t(3945),o),r(t(3247),o),r(t(6696),o),r(t(6233),o)},6696:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.get_valid_opponent_moves=o.not_from_hand_candidates_with_kut2tam2=o.not_from_hand_candidates=o.not_from_hand_candidates_=o.from_hand_candidates=o.empty_squares=o.get_opponent_pieces_rotated=o.isWater=o.isWaterAbs=o.fromAbsoluteCoord_=o.toAbsoluteCoord_=void 0;const n=t(6233),r=t(4974),i=t(3945);function a([e,o],t){return[["A","E","I","U","O","Y","AI","AU","IA"][t?e:8-e],["K","L","N","T","Z","X","C","M","P"][t?o:8-o]]}function s([e,o]){return 4===e&&2===o||4===e&&3===o||4===e&&4===o||4===e&&5===o||4===e&&6===o||2===e&&4===o||3===e&&4===o||5===e&&4===o||6===e&&4===o}o.toAbsoluteCoord_=a,o.fromAbsoluteCoord_=function([e,o],t){let n,r;if("A"===e)n=0;else if("E"===e)n=1;else if("I"===e)n=2;else if("U"===e)n=3;else if("O"===e)n=4;else if("Y"===e)n=5;else if("AI"===e)n=6;else if("AU"===e)n=7;else{if("IA"!==e)throw new Error("does not happen");n=8}if("K"===o)r=0;else if("L"===o)r=1;else if("N"===o)r=2;else if("T"===o)r=3;else if("Z"===o)r=4;else if("X"===o)r=5;else if("C"===o)r=6;else if("M"===o)r=7;else{if("P"!==o)throw new Error("does not happen");r=8}return t?[n,r]:[8-n,8-r]},o.isWaterAbs=function([e,o]){return"O"===e&&"N"===o||"O"===e&&"T"===o||"O"===e&&"Z"===o||"O"===e&&"X"===o||"O"===e&&"C"===o||"I"===e&&"Z"===o||"U"===e&&"Z"===o||"Y"===e&&"Z"===o||"AI"===e&&"Z"===o},o.isWater=s;const l=[0,1,2,3,4,5,6,7,8];o.get_opponent_pieces_rotated=e=>l.flatMap((o=>l.flatMap((t=>{const r=[o,t],i=e.f.currentBoard[o][t];return null===i?[]:"Tam2"===i?[{rotated_piece:i,rotated_coord:n.rotateCoord(r)}]:i.side===n.Side.Downward?[{rotated_piece:{prof:i.prof,color:i.color,side:n.Side.Upward},rotated_coord:n.rotateCoord(r)}]:[]})))),o.empty_squares=e=>l.flatMap((o=>l.flatMap((t=>{const n=[o,t];return null==e.f.currentBoard[o][t]?[n]:[]}))));const c=(e,o)=>i.eightNeighborhood(o).filter((([o,t])=>null==e[o][t]));o.from_hand_candidates=e=>e.f.hop1zuo1OfDownward.flatMap((t=>o.empty_squares(e).flatMap((o=>[{type:"NonTamMove",data:{type:"FromHand",color:t.color,prof:t.prof,dest:a(o,e.IA_is_down)}}])))),o.not_from_hand_candidates_=(e,t)=>o.get_opponent_pieces_rotated(t).flatMap((({rotated_piece:o,rotated_coord:l})=>{const{finite:d,infinite:u}=i.calculateMovablePositions(l,o,n.rotateBoard(t.f.currentBoard),t.tam_itself_is_tam_hue),f=[...d.map(n.rotateCoord),...u.map(n.rotateCoord)],_=n.rotateCoord(l);return f.flatMap((d=>{function u(e,o,t){return s(e)&&!s(t)&&o!==r.Profession.Nuak1}const f=t.f.currentBoard[d[0]][d[1]],p=e=>{const o=d,r=n.rotateBoard(t.f.currentBoard);r[l[0]][l[1]]=null;const{finite:s,infinite:c}=i.calculateMovablePositions(n.rotateCoord(o),e,r,t.tam_itself_is_tam_hue),f=s.map(n.rotateCoord),p=c.map(n.rotateCoord);return[...f.flatMap((s=>i.canGetOccupiedBy(n.Side.Downward,s,{color:e.color,prof:e.prof,side:n.Side.Downward},n.rotateBoard(r),t.tam_itself_is_tam_hue)?[{type:"NonTamMove",data:{type:"SrcStepDstFinite",src:a(_,t.IA_is_down),step:a(o,t.IA_is_down),dest:a(s,t.IA_is_down),is_water_entry_ciurl:u(s,e.prof,_)}}]:[])),...p.flatMap((s=>i.canGetOccupiedBy(n.Side.Downward,s,{color:e.color,prof:e.prof,side:n.Side.Downward},n.rotateBoard(r),t.tam_itself_is_tam_hue)?[{type:"InfAfterStep",src:a(_,t.IA_is_down),step:a(o,t.IA_is_down),plannedDirection:a(s,t.IA_is_down),stepping_ciurl:null,finalResult:null}]:[]))]};if("Tam2"===o){const e=n.rotateBoard(t.f.currentBoard);if(e[l[0]][l[1]]=null,null===f){const o=d;return i.eightNeighborhood(o).flatMap((r=>{if(null==t.f.currentBoard[r[0]][r[1]]||n.coordEq(r,_))return[{type:"TamMove",stepStyle:"NoStep",secondDest:a(r,t.IA_is_down),firstDest:a(o,t.IA_is_down),src:a(_,t.IA_is_down)}];{const i=r;return c(n.rotateBoard(e),i).flatMap((e=>[{type:"TamMove",stepStyle:"StepsDuringLatter",firstDest:a(o,t.IA_is_down),secondDest:a(e,t.IA_is_down),src:a(_,t.IA_is_down),step:a(i,t.IA_is_down)}]))}}))}{const o=d;return c(n.rotateBoard(e),o).flatMap((r=>c(n.rotateBoard(e),r).flatMap((e=>[{type:"TamMove",stepStyle:"StepsDuringFormer",firstDest:a(r,t.IA_is_down),secondDest:a(e,t.IA_is_down),src:a(_,t.IA_is_down),step:a(o,t.IA_is_down)}]))))}}return null===f?[{type:"NonTamMove",data:{type:"SrcDst",src:a(_,t.IA_is_down),dest:a(d,t.IA_is_down),is_water_entry_ciurl:u(d,o.prof,_)}}]:"Tam2"===f?e.allow_kut2tam2?p(o):[]:f.side===n.Side.Upward&&i.canGetOccupiedBy(n.Side.Downward,d,{color:o.color,prof:o.prof,side:n.Side.Downward},t.f.currentBoard,t.tam_itself_is_tam_hue)?[{type:"NonTamMove",data:{type:"SrcDst",src:a(_,t.IA_is_down),dest:a(d,t.IA_is_down),is_water_entry_ciurl:u(d,o.prof,_)}},...p(o)]:p(o)}))})),o.not_from_hand_candidates=e=>o.not_from_hand_candidates_({allow_kut2tam2:!1},e),o.not_from_hand_candidates_with_kut2tam2=e=>o.not_from_hand_candidates_({allow_kut2tam2:!0},e),o.get_valid_opponent_moves=function(e){return[...o.from_hand_candidates(e),...o.not_from_hand_candidates_({allow_kut2tam2:!1},e)]}},6233:(e,o)=>{var t;Object.defineProperty(o,"__esModule",{value:!0}),o.rotateBoard=o.rotateCoord=o.coordEq=o.toUpOrDown=o.fromUpOrDown=o.Side=void 0,function(e){e[e.Upward=0]="Upward",e[e.Downward=1]="Downward"}(t=o.Side||(o.Side={})),o.fromUpOrDown=function(e){return{color:e.color,prof:e.prof,side:e.side}},o.toUpOrDown=function(e){return e.side,t.Downward,{color:e.color,prof:e.prof,side:e.side}},o.coordEq=function(e,o){return e[0]===o[0]&&e[1]===o[1]},o.rotateCoord=function(e){return[8-e[0],8-e[1]]},o.rotateBoard=function(e){const o=[[null,null,null,null,null,null,null,null,"Tam2"],[null,null,null,null,null,null,null,null,"Tam2"],[null,null,null,null,null,null,null,null,"Tam2"],[null,null,null,null,null,null,null,null,"Tam2"],[null,null,null,null,null,null,null,null,"Tam2"],[null,null,null,null,null,null,null,null,"Tam2"],[null,null,null,null,null,null,null,null,"Tam2"],[null,null,null,null,null,null,null,null,"Tam2"],[null,null,null,null,null,null,null,null,"Tam2"]];for(let n=0;n<9;n++)for(let r=0;r<9;r++)o[n][r]=null===(t=e[8-n][8-r])||"Tam2"===t?t:{prof:t.prof,color:t.color,side:1-t.side};var t;return o}},6388:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.filter=void 0;const n=t(3379);o.filter=function(e,o){const t=(0,n.flatMap)(e,(e=>o(e)?[e]:[]));if(1===t.length)return t[0]}},9459:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.findInAncestorNodes=void 0;const n=t(9711),r=t(9577);o.findInAncestorNodes=function(e,o){return(0,r.find)((0,n.traverseAncestorNodes)(e),(e=>o(e)))}},7013:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.findInDescendantNodes=void 0;const n=t(7584),r=t(9577);o.findInDescendantNodes=function(e,o){return(0,r.find)((0,n.traverseDescendantNodes)(e),(e=>o(e)))}},785:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.findInFollowingSiblingNodes=void 0,o.findInFollowingSiblingNodes=function e(o,t){const n=o.nextSibling;if(n)return t(n)?n:e(n,t)}},5396:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.findInPrecedingSiblingNodes=void 0,o.findInPrecedingSiblingNodes=function e(o,t){const n=o.previousSibling;if(n)return t(n)?n:e(n,t)}},8463:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.find=void 0;const n=t(7013);o.find=function(e,o){return o(e)?e:(0,n.findInDescendantNodes)(e,o)}},3379:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.flatMap=void 0;const n=t(7773),r=t(9485);o.flatMap=function e(o,t){return(0,n.cloneNodes)(t((0,n.clone)(o))).map((o=>{const i=[];for(const r of o.childNodes)i.push(...(0,n.cloneNodes)(e(r,t)));return(0,r.removeAllChildren)(o),(0,n.copyNodesToChildNodes)(i,o),o}))}},4392:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.getAllBySelector=void 0;const n=t(1867),r=t(8120);o.getAllBySelector=function(e){const o=((0,r.isElement)(this)||(0,n.isDocument)(this)?this:document).querySelectorAll(e);if(o.length)return Array.from(o);throw new Error(`Could not find any elements matching ${e}`)}},7998:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.getBySelector=void 0;const n=t(1867),r=t(8120);o.getBySelector=function(e){const o=((0,r.isElement)(this)||(0,n.isDocument)(this)?this:document).querySelector(e);if(o)return o;throw new Error(`Could not find any elements matching ${e}`)}},7421:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||n(o,e,t)};Object.defineProperty(o,"__esModule",{value:!0}),r(t(3379),o),r(t(1175),o),r(t(6388),o),r(t(6769),o),r(t(8463),o),r(t(6669),o),r(t(5222),o),r(t(6820),o),r(t(9485),o),r(t(7494),o),r(t(7998),o),r(t(4392),o),r(t(9711),o),r(t(9459),o),r(t(7584),o),r(t(7013),o),r(t(785),o),r(t(5396),o),r(t(4615),o),r(t(2827),o),r(t(5537),o),r(t(834),o),r(t(5167),o),r(t(1867),o),r(t(9103),o),r(t(8120),o),r(t(5261),o),r(t(8365),o),r(t(9674),o),r(t(1559),o),r(t(1457),o),r(t(5255),o),r(t(733),o),r(t(4088),o),r(t(7449),o),r(t(4943),o),r(t(6872),o),r(t(2979),o)},2979:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isAfter=void 0,o.isAfter=function(e,o){return!!(e.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_PRECEDING)}},6872:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isBefore=void 0,o.isBefore=function(e,o){return!!(e.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING)}},1867:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isDocument=void 0;const n=t(4088),r=t(4510);o.isDocument=function(e){return"HTMLDocument"in globalThis&&e instanceof HTMLDocument||(0,r.isRecord)(e)&&e.nodeType===n.NodeType.DOCUMENT_NODE}},8120:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isElement=void 0;const n=t(4088),r=t(4510);o.isElement=function(e){return"HTMLElement"in globalThis&&e instanceof HTMLElement||(0,r.isRecord)(e)&&e.nodeType===n.NodeType.ELEMENT_NODE}},8365:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isNode=void 0;const n=t(4510);o.isNode=function(e){return"Node"in globalThis&&e instanceof Node||(0,n.isObject)(e)&&"nodeType"in e}},5255:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isParentNode=void 0;const n=t(8365);o.isParentNode=function(e){return(0,n.isNode)(e)&&"children"in e}},1559:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isTextNode=void 0;const n=t(4088),r=t(4510);o.isTextNode=function(e){return"Text"in globalThis&&e instanceof Text||(0,r.isRecord)(e)&&e.nodeType===n.NodeType.TEXT_NODE}},9103:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isntDocument=void 0;const n=t(1867);o.isntDocument=function(e){return!(0,n.isDocument)(e)}},5261:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isntElement=void 0;const n=t(8120);o.isntElement=function(e){return!(0,n.isElement)(e)}},9674:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isntNode=void 0;const n=t(8365);o.isntNode=function(e){return!(0,n.isNode)(e)}},733:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isntParentNode=void 0;const n=t(5255);o.isntParentNode=function(e){return!(0,n.isParentNode)(e)}},1457:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isntTextNode=void 0;const n=t(1559);o.isntTextNode=function(e){return!(0,n.isTextNode)(e)}},1175:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.map=void 0;const n=t(7773);o.map=function e(o,t){const r=(0,n.clone)(t((0,n.clone)(o)));for(const o of r.childNodes)r.replaceChild(e(o,t),o);return r}},834:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.nextElementSibling=void 0;const n=t(8120),r=t(3271);function i(e,o){const t=e.nextSibling;if(t)return(0,n.isElement)(t)?1===o?t:i(t,o-1):i(t,o)}o.nextElementSibling=function(e,o=1){return(0,r.assert)(Number.isInteger(o),"parameter distance must be an integer"),(0,r.assert)(o>=1,"parameter distance must be greater than or equal to 1"),i(e,o)}},2827:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.nextSibling=void 0;const n=t(3271);function r(e,o){const t=e.nextSibling;if(t)return 1===o?t:r(t,o-1)}o.nextSibling=function(e,o=1){return(0,n.assert)(Number.isInteger(o),"parameter distance must be an integer"),(0,n.assert)(o>=1,"parameter distance must be greater than or equal to 1"),r(e,o)}},4088:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.NodeType=void 0;const t="Node"in globalThis;var n;(n=o.NodeType||(o.NodeType={}))[n.ELEMENT_NODE=t?globalThis.Node.ELEMENT_NODE:1]="ELEMENT_NODE",n[n.ATTRIBUTE_NODE=t?globalThis.Node.ATTRIBUTE_NODE:2]="ATTRIBUTE_NODE",n[n.TEXT_NODE=t?globalThis.Node.TEXT_NODE:3]="TEXT_NODE",n[n.CDATA_SECTION_NODE=t?globalThis.Node.CDATA_SECTION_NODE:4]="CDATA_SECTION_NODE",n[n.ENTITY_REFERENCE_NODE=t?globalThis.Node.ENTITY_REFERENCE_NODE:5]="ENTITY_REFERENCE_NODE",n[n.ENTITY_NODE=t?globalThis.Node.ENTITY_NODE:6]="ENTITY_NODE",n[n.PROCESSING_INSTRUCTION_NODE=t?globalThis.Node.PROCESSING_INSTRUCTION_NODE:7]="PROCESSING_INSTRUCTION_NODE",n[n.COMMENT_NODE=t?globalThis.Node.COMMENT_NODE:8]="COMMENT_NODE",n[n.DOCUMENT_NODE=t?globalThis.Node.DOCUMENT_NODE:9]="DOCUMENT_NODE",n[n.DOCUMENT_TYPE_NODE=t?globalThis.Node.DOCUMENT_TYPE_NODE:10]="DOCUMENT_TYPE_NODE",n[n.DOCUMENT_FRAGMENT_NODE=t?globalThis.Node.DOCUMENT_FRAGMENT_NODE:11]="DOCUMENT_FRAGMENT_NODE",n[n.NOTATION_NODE=t?globalThis.Node.NOTATION_NODE:12]="NOTATION_NODE"},6820:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.normalize=void 0;const n=t(6669),r=t(5222);o.normalize=function(e){return(0,r.stringify)((0,n.parse)(e))}},4615:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.parentNode=void 0;const n=t(3271);function r(e,o){const t=e.parentNode;if(t)return 1===o?t:r(t,o-1)}o.parentNode=function(e,o=1){return(0,n.assert)(Number.isInteger(o),"parameter distance must be an integer"),(0,n.assert)(o>=1,"parameter distance must be greater than or equal to 1"),r(e,o)}},6669:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.parse=void 0,o.parse=function(e){const o=document.createElement("div");return o.innerHTML=e,[...o.childNodes]}},5167:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.previousElementSibling=void 0;const n=t(8120),r=t(3271);function i(e,o=1){const t=e.previousSibling;if(t)return(0,n.isElement)(t)?1===o?t:i(t,o-1):i(t,o)}o.previousElementSibling=function(e,o=1){return(0,r.assert)(Number.isInteger(o),"parameter distance must be an integer"),(0,r.assert)(o>=1,"parameter distance must be greater than or equal to 1"),i(e,o)}},5537:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.previousSibling=void 0;const n=t(3271);function r(e,o=1){const t=e.previousSibling;if(t)return 1===o?t:r(t,o-1)}o.previousSibling=function(e,o=1){return(0,n.assert)(Number.isInteger(o),"parameter distance must be an integer"),(0,n.assert)(o>=1,"parameter distance must be greater than or equal to 1"),r(e,o)}},9485:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.removeAllChildren=void 0,o.removeAllChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},7494:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.removeAttributes=void 0,o.removeAttributes=function(e,o){if(e instanceof Element){const t=Array.from(e.attributes).map((e=>e.name));for(const n of t)o(n)&&e.removeAttribute(n)}}},4943:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.replaceBrWithNewline=void 0;const n=t(1175);o.replaceBrWithNewline=function(e){return(0,n.map)(e,(e=>"BR"===e.nodeName?document.createTextNode("\n"):e))}},5222:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.stringify=void 0,o.stringify=function(e){const o=document.createElement("div");return e.forEach((e=>o.append(e.cloneNode(!0)))),o.innerHTML}},9711:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.traverseAncestorNodes=void 0,o.traverseAncestorNodes=function*e(o){const t=o.parentNode;t&&(yield t,yield*e(t))}},7584:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.traverseDescendantNodes=void 0,o.traverseDescendantNodes=function*e(o){for(const t of o.childNodes)yield t,yield*e(t)}},6769:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.unwrap=void 0;const n=t(3379),r=t(9577);o.unwrap=function e(o,t){return(0,n.flatMap)(o,(o=>t(o)?(0,r.toArray)((0,r.flatten)((0,r.map)(o.childNodes,(o=>e(o,t))))):[o]))}},7773:(e,o)=>{function t(e){return e.cloneNode(!0)}Object.defineProperty(o,"__esModule",{value:!0}),o.copyNodesToChildNodes=o.cloneNodes=o.clone=void 0,o.clone=t,o.cloneNodes=function(e){return e.map((e=>t(e)))},o.copyNodesToChildNodes=function(e,o){e.forEach((e=>o.appendChild(e)))}},7449:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.XPathResultType=void 0;const t="XPathResult"in globalThis;var n;(n=o.XPathResultType||(o.XPathResultType={}))[n.ANY_TYPE=t?globalThis.XPathResult.ANY_TYPE:0]="ANY_TYPE",n[n.NUMBER_TYPE=t?globalThis.XPathResult.NUMBER_TYPE:1]="NUMBER_TYPE",n[n.STRING_TYPE=t?globalThis.XPathResult.STRING_TYPE:2]="STRING_TYPE",n[n.BOOLEAN_TYPE=t?globalThis.XPathResult.BOOLEAN_TYPE:3]="BOOLEAN_TYPE",n[n.UNORDERED_NODE_ITERATOR_TYPE=t?globalThis.XPathResult.UNORDERED_NODE_ITERATOR_TYPE:4]="UNORDERED_NODE_ITERATOR_TYPE",n[n.ORDERED_NODE_ITERATOR_TYPE=t?globalThis.XPathResult.ORDERED_NODE_ITERATOR_TYPE:5]="ORDERED_NODE_ITERATOR_TYPE",n[n.UNORDERED_NODE_SNAPSHOT_TYPE=t?globalThis.XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE:6]="UNORDERED_NODE_SNAPSHOT_TYPE",n[n.ORDERED_NODE_SNAPSHOT_TYPE=t?globalThis.XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:7]="ORDERED_NODE_SNAPSHOT_TYPE",n[n.ANY_UNORDERED_NODE_TYPE=t?globalThis.XPathResult.ANY_UNORDERED_NODE_TYPE:8]="ANY_UNORDERED_NODE_TYPE",n[n.FIRST_ORDERED_NODE_TYPE=t?globalThis.XPathResult.FIRST_ORDERED_NODE_TYPE:9]="FIRST_ORDERED_NODE_TYPE"},9577:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||n(o,e,t)};Object.defineProperty(o,"__esModule",{value:!0}),r(t(7628),o),r(t(3449),o)},1143:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.chunkAsync=void 0;const n=t(6065),r=t(3271);o.chunkAsync=function(e,o){return(0,r.assert)(Number.isInteger(o),"The parameter size must be an integer"),(0,r.assert)(o>0,"The parameter size must be greater than 0"),(0,n.go)((async function*(){let t=[];for await(const n of e)t.push(n),t.length>=o&&(yield t,t=[]);t.length&&(yield t)}))}},2140:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.chunkByAsync=void 0;const n=t(4510);o.chunkByAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function*(e){let t=[],n=0;for await(const r of e)t.push(r),await o(r,n)&&(yield t,t=[]),n++;t.length&&(yield t)}(e):async function*(e){let t=[],n=0;for(const r of e)t.push(r),await o(r,n)&&(yield t,t=[]),n++;t.length&&(yield t)}(e)}},6811:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.chunkBy=void 0,o.chunkBy=function*(e,o){let t=[],n=0;for(const r of e)t.push(r),o(r,n)&&(yield t,t=[]),n++;t.length&&(yield t)}},3534:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.chunk=void 0;const n=t(6065),r=t(3271);o.chunk=function(e,o){return(0,r.assert)(Number.isInteger(o),"The parameter size must be an integer"),(0,r.assert)(o>0,"The parameter size must be greater than 0"),(0,n.go)((function*(){let t=[];for(const n of e)t.push(n),t.length>=o&&(yield t,t=[]);t.length&&(yield t)}))}},6262:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.concatAsync=void 0;const n=t(4510),r=t(6065);o.concatAsync=function(e,...o){return(0,r.go)((async function*(){for(const t of[e,...o])if((0,n.isAsyncIterable)(t))for await(const e of t)yield e;else for(const e of t)yield e}))}},6252:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.concat=void 0;const n=t(6065);o.concat=function(e,...o){return(0,n.go)((function*(){for(const t of[e,...o])yield*t}))}},3263:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.dropAsync=void 0;const n=t(6065),r=t(1056),i=t(3271);o.dropAsync=function(e,o){return(0,i.assert)(Number.isInteger(o),"The parameter count must be an integer"),(0,i.assert)(o>=0,"The parameter count must be greater than or equal to 0"),0===o?(0,r.copyAsyncIterable)(e):(0,n.go)((async function*(){var t;const n=e[Symbol.asyncIterator]();let r;try{let e;for(;({value:e,done:r}=await n.next()),!(r||o<=0);)o--;for(;!r;)yield e,({value:e,done:r}=await n.next())}finally{r||await(null===(t=n.return)||void 0===t?void 0:t.call(n))}}))}},3750:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.dropRightAsync=void 0;const n=t(6065),r=t(1056),i=t(3271);o.dropRightAsync=function(e,o){return(0,i.assert)(Number.isInteger(o),"The parameter count must be an integer"),(0,i.assert)(o>=0,"The parameter count must be greater than or equal to 0"),0===o?(0,r.copyAsyncIterable)(e):(0,n.go)((async function*(){const t=await async function(e){const o=[];for await(const t of e)o.push(t);return o}(e),n=t.slice(0,-o);for(const e of n)yield e}))}},7375:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.dropRight=void 0;const n=t(6065),r=t(1056),i=t(3271);o.dropRight=function(e,o){return(0,i.assert)(Number.isInteger(o),"The parameter count must be an integer"),(0,i.assert)(o>=0,"The parameter count must be greater than or equal to 0"),0===o?(0,r.copyIterable)(e):(0,n.go)((function*(){const t=Array.from(e);yield*t.slice(0,-o)}))}},5852:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.dropUntilAsync=void 0;const n=t(4510);o.dropUntilAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function*(e){var t;const n=e[Symbol.asyncIterator]();let r;try{let e,i=0;for(;({value:e,done:r}=await n.next()),!r&&!await o(e,i++););for(;!r;)yield e,({value:e,done:r}=await n.next())}finally{r||await(null===(t=n.return)||void 0===t?void 0:t.call(n))}}(e):async function*(e){var t;const n=e[Symbol.iterator]();let r;try{let e,i=0;for(;({value:e,done:r}=n.next()),!r&&!await o(e,i++););for(;!r;)yield e,({value:e,done:r}=n.next())}finally{r||null===(t=n.return)||void 0===t||t.call(n)}}(e)}},4823:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.dropUntil=void 0,o.dropUntil=function*(e,o){var t;const n=e[Symbol.iterator]();let r;try{let e,i=0;for(;({value:e,done:r}=n.next()),!r&&!o(e,i++););for(;!r;)yield e,({value:e,done:r}=n.next())}finally{r||null===(t=n.return)||void 0===t||t.call(n)}}},7536:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.drop=void 0;const n=t(6065),r=t(1056),i=t(3271);o.drop=function(e,o){return(0,i.assert)(Number.isInteger(o),"The parameter count must be an integer"),(0,i.assert)(o>=0,"The parameter count must be greater than or equal to 0"),0===o?(0,r.copyIterable)(e):(0,n.go)((function*(){var t;const n=e[Symbol.iterator]();let r;try{let e;for(;({value:e,done:r}=n.next()),!(r||o<=0);)o--;for(;!r;)yield e,({value:e,done:r}=n.next())}finally{r||null===(t=n.return)||void 0===t||t.call(n)}}))}},1264:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.filterAsync=void 0;const n=t(4510);o.filterAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function*(e){let t=0;for await(const n of e)await o(n,t)&&(yield n),t++}(e):async function*(e){let t=0;for(const n of e)await o(n,t)&&(yield n),t++}(e)}},8792:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.filter=void 0,o.filter=function*(e,o){let t=0;for(const n of e)o(n,t)&&(yield n),t++}},840:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.flattenAsync=void 0;const n=t(3516);o.flattenAsync=function(e){return(0,n.flattenDeepAsync)(e,1)}},8454:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.flattenByAsync=void 0;const n=t(4510);function r(e){return(0,n.isIterable)(e)&&(0,n.isntChar)(e)}o.flattenByAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function*(e){for await(const n of e)r(n)&&await o(n,1)?yield*t(n,2):yield n}(e):function(e){return t(e,1)}(e);async function*t(e,n){for(const i of e)r(i)&&await o(i,n)?yield*t(i,n+1):yield i}}},5506:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.flattenBy=void 0;const n=t(4510);o.flattenBy=function(e,o){return function*e(t,r){for(const a of t)i=a,(0,n.isIterable)(i)&&(0,n.isntChar)(i)&&o(a,r)?yield*e(a,r+1):yield a;var i}(e,1)}},3516:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.flattenDeepAsync=void 0;const n=t(8454),r=t(3271);o.flattenDeepAsync=function(e,o=1/0){return(0,r.assert)(o===1/0||Number.isInteger(o),"The parameter depth must be an integer"),(0,r.assert)(o>=0,"The parameter depth must be greater than or equal to 0"),(0,n.flattenByAsync)(e,((e,t)=>t<=o))}},2561:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.flattenDeep=void 0;const n=t(5506),r=t(3271);o.flattenDeep=function(e,o=1/0){return(0,r.assert)(o===1/0||Number.isInteger(o),"The parameter depth must be an integer"),(0,r.assert)(o>=0,"The parameter depth must be greater than or equal to 0"),(0,n.flattenBy)(e,((e,t)=>t<=o))}},918:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.flatten=void 0;const n=t(2561);o.flatten=function(e){return(0,n.flattenDeep)(e,1)}},7628:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||n(o,e,t)};Object.defineProperty(o,"__esModule",{value:!0}),r(t(1143),o),r(t(2140),o),r(t(6811),o),r(t(3534),o),r(t(6262),o),r(t(6252),o),r(t(3263),o),r(t(3750),o),r(t(7375),o),r(t(5852),o),r(t(4823),o),r(t(7536),o),r(t(1264),o),r(t(8792),o),r(t(840),o),r(t(8454),o),r(t(5506),o),r(t(3516),o),r(t(2561),o),r(t(918),o),r(t(502),o),r(t(3160),o),r(t(9421),o),r(t(7538),o),r(t(3224),o),r(t(5849),o),r(t(9683),o),r(t(8519),o),r(t(592),o),r(t(5629),o),r(t(1836),o),r(t(526),o),r(t(3090),o),r(t(7077),o),r(t(6942),o),r(t(10),o),r(t(2986),o),r(t(1935),o),r(t(546),o),r(t(9849),o),r(t(2637),o),r(t(6680),o),r(t(9848),o),r(t(9380),o),r(t(2902),o),r(t(541),o),r(t(4773),o)},502:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.mapAsync=void 0;const n=t(4510);o.mapAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function*(e){let t=0;for await(const n of e)yield await o(n,t),t++}(e):async function*(e){let t=0;for(const n of e)yield await o(n,t),t++}(e)}},3160:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.map=void 0,o.map=function*(e,o){let t=0;for(const n of e)yield o(n,t),t++}},9421:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.repeatAsync=void 0;const n=t(6065),r=t(3271);o.repeatAsync=function(e,o){return(0,r.assert)(o===1/0||Number.isInteger(o),"The parameter times must be an integer"),(0,r.assert)(o>=0,"The parameter times must be greater than or equal to 0"),(0,n.go)((async function*(){const t=[];if(o>0){for await(const o of e)yield o,t.push(o);o--}for(;o>0;)yield*t,o--}))}},7538:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.repeat=void 0;const n=t(6065),r=t(3271);o.repeat=function(e,o){return(0,r.assert)(o===1/0||Number.isInteger(o),"The parameter times must be an integer"),(0,r.assert)(o>=0,"The parameter times must be greater than or equal to 0"),(0,n.go)((function*(){const t=[];if(o>0){for(const o of e)yield o,t.push(o);o--}for(;o>0;)yield*t,o--}))}},3224:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.sliceAsync=void 0;const n=t(6065),r=t(3271);o.sliceAsync=function(e,o,t=1/0){return(0,r.assert)(Number.isInteger(o),"The parameter start must be an integer"),(0,r.assert)(o>=0,"The parameter start must be greater than or equal to 0"),(0,r.assert)(Number.isInteger(t),"The parameter end must be an integer"),(0,r.assert)(t>=o,"The parameter end must be greater than or equal to start"),(0,n.go)((async function*(){let n=0;for await(const r of e){if(n>=t)break;n>=o&&(yield r),n++}}))}},5849:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.slice=void 0;const n=t(6065),r=t(3271);o.slice=function(e,o,t=1/0){return(0,r.assert)(Number.isInteger(o),"The parameter start must be an integer"),(0,r.assert)(o>=0,"The parameter start must be greater than or equal to 0"),(0,r.assert)(Number.isInteger(t),"The parameter end must be an integer"),(0,r.assert)(t>=o,"The parameter end must be greater than or equal to start"),(0,n.go)((function*(){let n=0;for(const r of e){if(n>=t)break;n>=o&&(yield r),n++}}))}},9683:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.splitAsync=void 0,o.splitAsync=async function*(e,o){let t=[];for await(const n of e)n===o?(yield t,t=[]):t.push(n);yield t}},8519:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.splitByAsync=void 0;const n=t(4510);o.splitByAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function*(e){let t=[],n=0;for await(const r of e)await o(r,n)?(yield t,t=[]):t.push(r),n++;yield t}(e):async function*(e){let t=[],n=0;for(const r of e)await o(r,n)?(yield t,t=[]):t.push(r),n++;yield t}(e)}},592:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.splitBy=void 0,o.splitBy=function*(e,o){let t=[],n=0;for(const r of e)o(r,n)?(yield t,t=[]):t.push(r),n++;yield t}},5629:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.split=void 0,o.split=function*(e,o){let t=[];for(const n of e)n===o?(yield t,t=[]):t.push(n);yield t}},1836:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.takeAsync=void 0;const n=t(6065),r=t(3271);o.takeAsync=function(e,o){return(0,r.assert)(Number.isInteger(o),"The parameter count must be an integer"),(0,r.assert)(o>=0,"The parameter count must be greater than or equal to 0"),(0,n.go)((async function*(){if(0!==o)for await(const t of e)if(yield t,0==--o)break}))}},526:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.takeRightAsync=void 0;const n=t(6065),r=t(3271);o.takeRightAsync=function(e,o){return(0,r.assert)(Number.isInteger(o),"The parameter count must be an integer"),(0,r.assert)(o>=0,"The parameter count must be greater than or equal to 0"),(0,n.go)((async function*(){var t;const n=e[Symbol.asyncIterator]();let r;try{const e=[];let i;for(;({value:i,done:r}=await n.next()),!r;)e.push(i),e.length>o&&e.shift();yield*e}finally{r||await(null===(t=n.return)||void 0===t?void 0:t.call(n))}}))}},3090:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.takeRight=void 0;const n=t(6065),r=t(3271);o.takeRight=function(e,o){return(0,r.assert)(Number.isInteger(o),"The parameter count must be an integer"),(0,r.assert)(o>=0,"The parameter count must be greater than or equal to 0"),(0,n.go)((function*(){var t;const n=e[Symbol.iterator]();let r;try{const e=[];let i;for(;({value:i,done:r}=n.next()),!r;)e.push(i),e.length>o&&e.shift();yield*e}finally{r||null===(t=n.return)||void 0===t||t.call(n)}}))}},7077:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.takeUntilAsync=void 0;const n=t(4510);o.takeUntilAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function*(e){let t=0;for await(const n of e){if(await o(n,t))break;yield n,t++}}(e):async function*(e){let t=0;for(const n of e){if(await o(n,t))break;yield n,t++}}(e)}},6942:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.takeUntil=void 0,o.takeUntil=function*(e,o){let t=0;for(const n of e){if(o(n,t))break;yield n,t++}}},10:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.take=void 0;const n=t(6065),r=t(3271);o.take=function(e,o){return(0,r.assert)(Number.isInteger(o),"The parameter count must be an integer"),(0,r.assert)(o>=0,"The parameter count must be greater than or equal to 0"),(0,n.go)((function*(){if(0!==o)for(const t of e)if(yield t,0==--o)break}))}},2986:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.tapAsync=void 0;const n=t(4510);o.tapAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function*(e){let t=0;for await(const n of e)await o(n,t),yield n,t++}(e):async function*(e){let t=0;for(const n of e)await o(n,t),yield n,t++}(e)}},1935:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.tap=void 0,o.tap=function*(e,o){let t=0;for(const n of e)o(n,t),yield n,t++}},546:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toAsyncIterable=void 0,o.toAsyncIterable=async function*(e){for(const o of e)yield o}},9849:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.transformAsync=void 0,o.transformAsync=async function*(e,o){yield*o(e)}},2637:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.transform=void 0,o.transform=function*(e,o){yield*o(e)}},6680:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.uniqAsync=void 0,o.uniqAsync=async function*(e){const o=new Set;for await(const t of e)o.has(t)||(yield t,o.add(t))}},9848:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.uniqByAsync=void 0;const n=t(4510);o.uniqByAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function*(e){const t=new Set;let n=0;for await(const r of e){const e=await o(r,n);t.has(e)||(yield r,t.add(e)),n++}}(e):async function*(e){const t=new Set;let n=0;for(const r of e){const e=await o(r,n);t.has(e)||(yield r,t.add(e)),n++}}(e)}},9380:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.uniqBy=void 0,o.uniqBy=function*(e,o){const t=new Set;let n=0;for(const r of e){const e=o(r,n);t.has(e)||(yield r,t.add(e)),n++}}},2902:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.uniq=void 0,o.uniq=function*(e){const o=new Set;for(const t of e)o.has(t)||(yield t,o.add(t))}},541:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.zipAsync=void 0;const n=t(4510);var r;!function(e){e[e.Sync=0]="Sync",e[e.Async=1]="Async"}(r||(r={})),o.zipAsync=function(e,...o){return async function*(...e){var o,t,i,a;const s=e.length,l=e.map((e=>(0,n.isAsyncIterable)(e)?[r.Async,e[Symbol.asyncIterator]()]:[r.Sync,e[Symbol.iterator]()])),c=l.map((()=>!1));try{for(;;){const e=new Array(s);for(let o=0;o<s;o++){const[t,n]=l[o];let i;if(i=t===r.Async?await n.next():n.next(),i.done)return void(c[o]=!0);e[o]=i.value}yield e}}finally{const e=l.filter(((e,o)=>!c[o]));for(const[n,s]of e)n===r.Async?await(null===(t=(o=s).return)||void 0===t?void 0:t.call(o)):null===(a=(i=s).return)||void 0===a||a.call(i)}}(e,...o)}},4773:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.zip=void 0,o.zip=function(e,...o){return function*(...e){const o=e.length,t=e.map((e=>e[Symbol.iterator]())),n=t.map((()=>!1));try{for(;;){const e=new Array(o);for(let r=0;r<o;r++){const{value:o,done:i}=t[r].next();if(i)return void(n[r]=!0);e[r]=o}yield e}}finally{t.filter(((e,o)=>!n[o])).forEach((e=>{var o;return null===(o=e.return)||void 0===o?void 0:o.call(e)}))}}(e,...o)}},8759:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.consume=void 0,o.consume=function(e,o){return o(e)}},8663:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.eachAsync=void 0;const n=t(4510);o.eachAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function(e){let t=0;for await(const n of e)await o(n,t),t++}(e):async function(e){let t=0;for(const n of e)await o(n,t),t++}(e)}},4942:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.each=void 0,o.each=function(e,o){let t=0;for(const n of e)o(n,t),t++}},5821:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.everyAsync=void 0;const n=t(4510);o.everyAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function(e){let t=0;for await(const n of e){if(!await o(n,t))return!1;t++}return!0}(e):async function(e){let t=0;for(const n of e){if(!await o(n,t))return!1;t++}return!0}(e)}},2825:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.every=void 0,o.every=function(e,o){let t=0;for(const n of e){if(!o(n,t))return!1;t++}return!0}},6642:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.findAsync=void 0;const n=t(4510);o.findAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function(e){let t=0;for await(const n of e){if(await o(n,t))return n;t++}}(e):async function(e){let t=0;for(const n of e){if(await o(n,t))return n;t++}}(e)}},3455:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.find=void 0,o.find=function(e,o){let t=0;for(const n of e){if(o(n,t))return n;t++}}},7226:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.firstAsync=void 0,o.firstAsync=async function(e){for await(const o of e)return o}},3819:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.first=void 0,o.first=function(e){for(const o of e)return o}},9246:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.includesAsync=void 0,o.includesAsync=async function(e,o){for await(const t of e)if(t===o)return!0;return!1}},5190:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.includes=void 0,o.includes=function(e,o){for(const t of e)if(t===o)return!0;return!1}},3449:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||n(o,e,t)};Object.defineProperty(o,"__esModule",{value:!0}),r(t(8759),o),r(t(8663),o),r(t(4942),o),r(t(5821),o),r(t(2825),o),r(t(6642),o),r(t(3455),o),r(t(7226),o),r(t(3819),o),r(t(9246),o),r(t(5190),o),r(t(254),o),r(t(7292),o),r(t(7317),o),r(t(2524),o),r(t(8525),o),r(t(3088),o),r(t(1322),o),r(t(4816),o),r(t(378),o),r(t(6304),o),r(t(8451),o),r(t(8538),o)},1322:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.lastAsync=void 0,o.lastAsync=async function(e){var o;const t=e[Symbol.asyncIterator]();let n;try{let e,r;for(;({value:e,done:n}=await t.next()),!n;)r=e;return r}finally{n||await(null===(o=t.return)||void 0===o?void 0:o.call(t))}}},4816:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.last=void 0,o.last=function(e){var o;const t=e[Symbol.iterator]();let n;try{let e,r;for(;({value:e,done:n}=t.next()),!n;)r=e;return r}finally{n||null===(o=t.return)||void 0===o||o.call(t)}}},254:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.matchAsync=void 0,o.matchAsync=async function(e,o){const t=o.length;let n=0;for await(const r of e)if(r===o[n]&&n++,n===t)return!0;return!1}},7292:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.match=void 0,o.match=function(e,o){const t=o.length;let n=0;for(const r of e)if(r===o[n]&&n++,n===t)return!0;return!1}},7317:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.reduceAsync=void 0;const n=t(4510);o.reduceAsync=function(e,o,t){return(0,n.isUndefined)(t)?function(e,o){return(0,n.isAsyncIterable)(e)?async function(e){var t;const n=e[Symbol.asyncIterator]();let r;try{let e,i=await async function(e){const o=await e.next();if(o.done)throw r=!0,new Error("Reduce of empty iterable with no initial value");return o.value}(n),a=1;for(;({value:e,done:r}=await n.next()),!r;)i=await o(i,e,a++);return i}finally{r||await(null===(t=n.return)||void 0===t?void 0:t.call(n))}}(e):async function(e){var t;const n=e[Symbol.iterator]();let r;try{let e,i=function(e){const o=e.next();if(o.done)throw r=!0,new Error("Reduce of empty iterable with no initial value");return o.value}(n),a=1;for(;({value:e,done:r}=n.next()),!r;)i=await o(i,e,a++);return i}finally{r||null===(t=n.return)||void 0===t||t.call(n)}}(e)}(e,o):function(e,o,t){return(0,n.isAsyncIterable)(e)?async function(e){let n=t,r=0;for await(const t of e)n=await o(n,t,r++);return n}(e):async function(e){let n=t,r=0;for(const t of e)n=await o(n,t,r++);return n}(e)}(e,o,t)}},2524:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.reduce=void 0;const n=t(4510);o.reduce=function(e,o,t){return(0,n.isUndefined)(t)?function(e,o){var t;const n=e[Symbol.iterator]();let r;try{let e,i=function(e){const o=e.next();if(o.done)throw r=!0,new Error("Reduce of empty iterable with no initial value");return o.value}(n),a=1;for(;({value:e,done:r}=n.next()),!r;)i=o(i,e,a++);return i}finally{r||null===(t=n.return)||void 0===t||t.call(n)}}(e,o):function(e,o,t){let n=t,r=0;for(const t of e)n=o(n,t,r++);return n}(e,o,t)}},8525:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.someAsync=void 0;const n=t(4510);o.someAsync=function(e,o){return(0,n.isAsyncIterable)(e)?async function(e){let t=0;for await(const n of e){if(await o(n,t))return!0;t++}return!1}(e):async function(e){let t=0;for(const n of e){if(await o(n,t))return!0;t++}return!1}(e)}},3088:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.some=void 0,o.some=function(e,o){let t=0;for(const n of e){if(o(n,t))return!0;t++}return!1}},378:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toArrayAsync=void 0;const n=t(8759);o.toArrayAsync=function(e){return(0,n.consume)(e,(async e=>{const o=[];for await(const t of e)o.push(t);return o}))}},6304:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toArray=void 0;const n=t(8759);o.toArray=function(e){return(0,n.consume)(e,(e=>Array.from(e)))}},8451:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toSetAsync=void 0;const n=t(8759);o.toSetAsync=function(e){return(0,n.consume)(e,(async e=>{const o=new Set;for await(const t of e)o.add(t);return o}))}},8538:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toSet=void 0;const n=t(8759);o.toSet=function(e){return(0,n.consume)(e,(e=>new Set(e)))}},1056:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.copyIterable=o.copyAsyncIterable=void 0,o.copyAsyncIterable=async function*(e){for await(const o of e)yield o},o.copyIterable=function*(e){for(const o of e)yield o}},2787:()=>{},9672:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__setModuleDefault||(Object.create?function(e,o){Object.defineProperty(e,"default",{enumerable:!0,value:o})}:function(e,o){e.default=o}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var o={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(o,e,t);return r(o,e),o};Object.defineProperty(o,"__esModule",{value:!0}),o.increaseRateAndAnimate=o.endSeason=o.sendStuffTo=o.calculateHandsAndScore=o.animatePunishStepTamAndCheckPerzej=o.drawField=o.drawMak2Io1=void 0;const a=t(8513),s=t(1849),l=t(892),c=t(4495),d=t(2120),u=t(2392),f=t(9798),_=t(8431),p=i(t(4204)),m=t(9447),y=t(4728),E=t(9090),w=t(8460),v=t(7421);function h(){const e=document.getElementById("denote_season");e.style.top=`${(0,c.getDenoteSeasonNodeTopLeft)(a.GAME_STATE.season).top}px`,e.style.transition="",e.style.transform="";const o=document.getElementById("denote_score");o.style.top=`${(0,c.getDenoteScoreNodeTopLeft)(a.GAME_STATE.my_score).top}px`,o.style.transition="",o.style.transform="";const t=document.getElementById("denote_rate");0===a.GAME_STATE.log2_rate?t.style.display="none":t.style.display="block",t.style.top=`${(0,c.getDenoteRateNodeTopLeft)(a.GAME_STATE.log2_rate).top}px`,t.style.transition="",t.style.transform=""}function A(e){console.log("focusing:",e.focus?(0,a.toAbsoluteCoord)(e.focus):null);{const o=a.GAME_STATE.f.currentBoard,t=document.getElementById("contains_pieces_on_board");(0,v.removeAllChildren)(t);for(let n=0;n<o.length;n++)for(let r=0;r<o[n].length;r++){const i=o[n][r];if(null==i)continue;const s=[n,r],c=(0,y.createPieceImgToBePlacedOnBoard)(s,i);if(c.id=`field_piece_${n}_${r}`,e.focus&&s[0]===e.focus[0]&&s[1]===e.focus[1]&&(c.style.border="8px solid #ff6",c.style.margin="-8px"),"Tam2"===i)a.GAME_STATE.opponent_has_just_moved_tam||(c.style.cursor="pointer",c.addEventListener("click",(function(){(0,E.selectOwnPieceOnBoard)(s,i)})));else if(i.side===l.Side.Upward){const e={prof:i.prof,side:l.Side.Upward,color:i.color};c.style.cursor="pointer",c.addEventListener("click",(function(){(0,E.selectOwnPieceOnBoard)(s,e)}))}t.appendChild(c)}}{const e=a.GAME_STATE.f.hop1zuo1OfUpward,o=document.getElementById("contains_pieces_on_upward");(0,v.removeAllChildren)(o);for(let t=0;t<e.length;t++){const n=e[t],r=(0,y.createPieceImgToBePlacedOnHop1zuo1)({ind:t,path:(0,w.toPath)(n),list_length:e.length,is_upward:!0});r.style.cursor="pointer",r.addEventListener("click",(function(){(0,E.selectOwnPieceOnHop1zuo1)(t,n,e.length)})),o.appendChild(r)}}{const e=a.GAME_STATE.f.hop1zuo1OfDownward,o=document.getElementById("contains_pieces_on_downward");(0,v.removeAllChildren)(o);for(let t=0;t<e.length;t++){const n=e[t],r=(0,y.createPieceImgToBePlacedOnHop1zuo1)({ind:t,path:(0,w.toPath)(n),list_length:e.length,is_upward:!1});r.id=`hop1zuo1OfDownward_${t}`,o.appendChild(r)}}}function T(e,o){(0,f.drawFinalScoreDisplay)(function(e,o){const t=e=>[e.slice(0,-1).reduce(((e,o)=>e+o),0),e[e.length-1]],n=e?e=>[e.reduce(((e,o)=>e+o),0)]:t;if(0===o[0].length)throw new Error("why did the game end without any movement of points?");return 0===o[1].length?[n(o[0])]:0===o[2].length?[t(o[0]),n(o[1])]:0===o[3].length?[t(o[0]),t(o[1]),n(o[2])]:[t(o[0]),t(o[1]),t(o[2]),n(o[3])]}(o,a.GAME_STATE.scores_of_each_season)),document.getElementById("my_icon").style.opacity="1",document.getElementById("larta_opponent").style.opacity="1",document.getElementById("opponent_message").textContent="you win!"===e?d.DICTIONARY.ja.gameResult.victory:"draw"===e?d.DICTIONARY.ja.gameResult.draw:d.DICTIONARY.ja.gameResult.loss,document.getElementById("opponent_message_linzklar").textContent="you win!"===e?d.GAME_END_LINZKLAR.victory:"draw"===e?d.GAME_END_LINZKLAR.draw:d.GAME_END_LINZKLAR.loss,p.push_body_elem_and_display({type:"tymoktaxot",dat:"星一周"}),p.push_header_elem_and_display({type:"header",dat:`{終時:${(new Date).toISOString()}}`})}o.drawMak2Io1=h,o.drawField=A,o.animatePunishStepTamAndCheckPerzej=async function(e){var o,t,n,r,i;document.getElementById("score_display").classList.add("nocover"),document.getElementById("yaku_all").style.left="750px";const s=document.getElementById("denote_score"),d=a.GAME_STATE.my_score;return a.GAME_STATE.my_score+=(e===l.Side.Upward?-5:5)*Math.pow(2,a.GAME_STATE.log2_rate),await new Promise((e=>setTimeout(e,161.86))),await(0,m.animateNode)(s,1e3*.8093,{to:(0,c.getDenoteScoreNodeTopLeft)(a.GAME_STATE.my_score),from:(0,c.getDenoteScoreNodeTopLeft)(d)}),a.GAME_STATE.my_score>=40?(T("you win!",!0),void(null===(o=document.getElementById("protective_cover_over_field_while_waiting_for_opponent"))||void 0===o||o.classList.remove("nocover"))):a.GAME_STATE.my_score<=0?(T("you lose...",!0),void(null===(t=document.getElementById("protective_cover_over_field_while_waiting_for_opponent"))||void 0===t||t.classList.remove("nocover"))):(await new Promise((e=>setTimeout(e,242.79))),h(),await new Promise((e=>setTimeout(e,242.79))),null===(n=document.getElementById("protective_cover_over_field"))||void 0===n||n.classList.add("nocover"),null===(r=document.getElementById("protective_tam_cover_over_field"))||void 0===r||r.classList.add("nocover"),void(null===(i=document.getElementById("protective_cover_over_field_while_asyncawait"))||void 0===i||i.classList.add("nocover")))},o.calculateHandsAndScore=function(e){const o=e.map((e=>{return o=e.color,t=e.prof,[["赤船","赤兵","赤弓","赤車","赤虎","赤馬","赤筆","赤巫","赤将","赤王"],["黒船","黒兵","黒弓","黒車","黒虎","黒馬","黒筆","黒巫","黒将","黒王"]][o][t];var o,t})),t=(0,_.calculate_hands_and_score_from_pieces)(o);if(!0===t.error)throw new Error(`should not happen: too many of ${t.too_many.join(",")}`);return{hands:t.hands,score:t.score}},o.sendStuffTo=async function(e,o,t,n){const r=document.getElementById("protective_cover_over_field_while_asyncawait");r.classList.remove("nocover"),console.log(`Sending ${o}:`,JSON.stringify(t));const i=`${u.API_ORIGIN}/${e}/`,a={message:t},s=await fetch(i,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json",Authorization:`Bearer ${sessionStorage.access_token}`}}).then((e=>(r.classList.add("nocover"),e.json()))).then(n).catch((e=>{r.classList.add("nocover"),console.error("Error:",e)}));if(console.log(s),r.classList.add("nocover"),!s)throw alert("network error!"),r.classList.add("nocover"),new Error("network error!");return s},o.endSeason=function(e,o){document.getElementById("score_display").classList.add("nocover"),document.getElementById("yaku_all").style.left="750px";const t=document.getElementById("denote_season"),n=document.getElementById("denote_score"),r=a.GAME_STATE.my_score,i=a.GAME_STATE.season;a.GAME_STATE.my_score+=e*Math.pow(2,a.GAME_STATE.log2_rate);const u={0:1,1:2,2:3,3:null}[i];null!=u?(a.GAME_STATE.season=u,setTimeout((async()=>{var e,u,f,_,y;await(0,m.animateNode)(n,1e3*.8093,{to:(0,c.getDenoteScoreNodeTopLeft)(a.GAME_STATE.my_score),from:(0,c.getDenoteScoreNodeTopLeft)(r)}),a.GAME_STATE.my_score>=40?T("you win!",!1):a.GAME_STATE.my_score<=0?T("you lose...",!1):(await(0,m.animateNode)(t,566.51,{to:(0,c.getDenoteSeasonNodeTopLeft)(a.GAME_STATE.season),from:(0,c.getDenoteSeasonNodeTopLeft)(i)}),await new Promise((e=>setTimeout(e,242.79))),h(),alert(d.DICTIONARY.ja.newSeason[a.GAME_STATE.season]),await new Promise((e=>setTimeout(e,242.79))),null===(e=document.getElementById("protective_cover_over_field"))||void 0===e||e.classList.remove("nocover"),null===(u=document.getElementById("protective_tam_cover_over_field"))||void 0===u||u.classList.remove("nocover"),await new Promise((e=>setTimeout(e,4e3*.8093))),a.GAME_STATE.f={currentBoard:a.GAME_STATE.IA_is_down?(0,l.rotateBoard)((0,l.rotateBoard)(a.initial_board_with_IA_down)):(0,l.rotateBoard)(a.initial_board_with_IA_down),hop1zuo1OfDownward:[],hop1zuo1OfUpward:[]},a.GAME_STATE.log2_rate=0,h(),(0,s.allowMainPolling)(),a.GAME_STATE.last_move_focus=null,console.log("drawField #",11),A({focus:null}),await new Promise((e=>setTimeout(e,242.79))),null===(f=document.getElementById("protective_cover_over_field"))||void 0===f||f.classList.add("nocover"),null===(_=document.getElementById("protective_tam_cover_over_field"))||void 0===_||_.classList.add("nocover"),a.GAME_STATE.is_my_turn=o,p.push_initial_colors_and_display(a.GAME_STATE.is_my_turn===a.GAME_STATE.IA_is_down?"黒":"赤"),null===(y=document.getElementById("protective_cover_over_field_while_asyncawait"))||void 0===y||y.classList.add("nocover"))}),161.86)):setTimeout((async()=>(await(0,m.animateNode)(n,1e3*.8093,{to:(0,c.getDenoteScoreNodeTopLeft)(a.GAME_STATE.my_score),from:(0,c.getDenoteScoreNodeTopLeft)(r)}),alert(d.DICTIONARY.ja.gameEnd),a.GAME_STATE.my_score>20?void T("you win!",!1):a.GAME_STATE.my_score<20?void T("you lose...",!1):void T("draw",!1))),161.86)},o.increaseRateAndAnimate=function(e){document.getElementById("score_display").classList.add("nocover"),document.getElementById("yaku_all").style.left="750px";const o=a.GAME_STATE.log2_rate;h(),a.GAME_STATE.log2_rate={0:1,1:2,2:3,3:4,4:5,5:6,6:6}[o];const t=document.getElementById("denote_rate");setTimeout((async()=>{t.style.display="block",await new Promise((e=>setTimeout(e,161.86))),await(0,m.animateNode)(t,1e3*.8093,{to:(0,c.getDenoteRateNodeTopLeft)(a.GAME_STATE.log2_rate),from:(0,c.getDenoteRateNodeTopLeft)(o)}),await new Promise((e=>setTimeout(e,500*.8093))),h(),e?((0,s.allowMainPolling)(),setTimeout(s.sendMainPollAndDoEverythingThatFollows,500*.8093)):a.GAME_STATE.is_my_turn=!0,document.getElementById("protective_cover_over_field_while_asyncawait").classList.add("nocover")}),161.86)}},2327:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toPieceCaptureComment=o.toColorProf=void 0;const n=t(488);o.toColorProf=function(e){if("Tam2"===e)throw new Error("Tam2 was passed to the function `toColorProf`");return null===e?null:[e.color,e.prof]},o.toPieceCaptureComment=function(e){if(null===e)return"";const[o,t]=e;return`手${(0,n.serializeColor)(o)}${(0,n.serializeProf)(t)}`}},4728:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createImageButton=o.createPieceImgToBePlacedOnBoard=o.createPieceImgToBePlacedOnHop1zuo1=o.createCiurl=o.createGuideImageAt=o.createPieceSizeSelectionButtonOnBoard_Shifted=o.createPieceSizeImageOnBoardByPath_Shifted=o.createCancelButton=o.createPieceSizeImageOnBoardByPath=o.createPieceSizeImageOnBoardByPathAndXY=o.createArrowSvg=o.createHandImage=o.createBapPokImage=void 0;const n=t(8460),r=t(4495);function i(e,o,t,n){const i=document.createElement("img");return i.setAttribute("draggable","false"),i.classList.add(n),i.style.top=`${e}px`,i.style.left=`${o}px`,i.src=`image/${t}.png`,i.width=r.PIECE_SIZE,i.height=r.PIECE_SIZE,i}function a(e,o,t){const{top:n,left:a}=(0,r.coordToPieceXY)(e);return i(n,a,o,t)}function s(e,o,t){const{top:n,left:a}=(0,r.coordToPieceXY_Shifted)(e);return i(n,a,o,t)}o.createBapPokImage=function(e){const o=document.createElement("img");return o.src="image/dat2/同色.png",o.style.position="absolute",o.style.left=`${e.left}px`,o.style.top=`${185+e.top_padding}px`,o.width=50,o},o.createHandImage=function(e,o){const t=document.createElement("img");return t.src=`image/dat2/${e}.png`,t.style.position="absolute",t.style.left=`${o.left}px`,t.style.top=`${o.top_padding}px`,t.width=50,t},o.createArrowSvg=function(e,o){const[t,n]=o,i=t*r.BOX_SIZE+160.5,a=n*r.BOX_SIZE+19.25-65,s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttributeNS(null,"viewBox","0 0 800 800"),s.setAttributeNS(null,"width","800"),s.setAttributeNS(null,"height","800"),s.classList.add("selection"),s.style.top=`${i}px`,s.style.left=`${a}px`;const l=document.createElementNS("http://www.w3.org/2000/svg","path");return l.setAttributeNS(null,"d",e),l.setAttributeNS(null,"fill","#aeff01"),l.setAttributeNS(null,"stroke","#000"),l.setAttributeNS(null,"stroke-width","2"),s.appendChild(l),s},o.createPieceSizeImageOnBoardByPathAndXY=i,o.createPieceSizeImageOnBoardByPath=a,o.createCancelButton=function(){return i(1+9*r.BOX_SIZE+(r.MAX_PIECE_SIZE-r.PIECE_SIZE),1+7.5*r.BOX_SIZE,"piece/bmun","piece_image_on_board")},o.createPieceSizeImageOnBoardByPath_Shifted=s,o.createPieceSizeSelectionButtonOnBoard_Shifted=function(e){const o=s(e,"selection2","selection");return o.style.cursor="pointer",o.style.zIndex="200",o},o.createGuideImageAt=function(e,o){const[t,n]=e,i=document.createElement("img");return i.setAttribute("draggable","false"),i.classList.add("guide"),i.style.top=1+t*r.BOX_SIZE+(r.MAX_PIECE_SIZE-r.MAX_PIECE_SIZE)/2+"px",i.style.left=1+n*r.BOX_SIZE+(r.MAX_PIECE_SIZE-r.MAX_PIECE_SIZE)/2+"px",i.src=`image/${o}.png`,i.width=r.MAX_PIECE_SIZE,i.height=r.MAX_PIECE_SIZE,i.style.cursor="守"===o?"not-allowed":"pointer",i.style.opacity="0.3",i},o.createCiurl=function(e,o){const t=document.createElement("img");return t.setAttribute("draggable","false"),t.src=`image/ciurl_${e}.png`,t.width=150,t.height=15,t.classList.add("ciurl"),t.style.left=`${o.left}px`,t.style.top=`${o.top}px`,t.style.zIndex="300",t.style.transform=`rotate(${o.rotateDeg}deg)`,t.style.position="absolute",t},o.createPieceImgToBePlacedOnHop1zuo1=function(e){const o=1+(r.MAX_PIECE_SIZE-r.PIECE_SIZE)/2;return i(e.is_upward?140-r.PIECE_SIZE-o:o,(0,r.hop1_zuo1_left_position)({ind:e.ind,list_length:e.list_length}),e.path,"piece_image_on_hop1zuo1")},o.createPieceImgToBePlacedOnBoard=function(e,o){return a(e,(0,n.toPath_)(o),"piece_image_on_board")},o.createImageButton=function(e,o){const t=document.createElement("input");return t.setAttribute("type","image"),t.src=`image/${e}.png`,t.height=200,t.style.backgroundColor="#e0e0e0",t.style.position="absolute",t.style.left="660px",t.style.top=`${o}px`,t.style.border="1px solid #aaaaaa",t}},2120:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DICTIONARY=o.GAME_END_LINZKLAR=o.TACTICS_LINZKLAR=void 0,o.TACTICS_LINZKLAR={victory_almost_certain:"我須上行。",strengthened_shaman:"為激巫。",free_lunch:"我為無与之手。",avoid_defeat:"心為此而無行下行之道。",loss_almost_certain:"為何即下行。行我心之道。",neutral:"無心来為何善。行周時無下行之道。"},o.GAME_END_LINZKLAR={victory:"汝上行終",draw:"汝値同於我",loss:"汝下行終"},o.DICTIONARY={ja:{whetherToTake:"駒を取る → [OK]\n駒を踏む → [Cancel]",failedWaterEntry:"入水判定に失敗しました。",newSeason:["","季節が改まり夏になりました。","季節が改まり秋になりました。","季節が改まり冬になりました。"],gameEnd:"試合終了です。",gameResult:{victory:"あなたの勝ちです",draw:"引き分けです",loss:"あなたの負けです"},tactics:{victory_almost_certain:"勝ち確",strengthened_shaman:"激巫作成",free_lunch:"ただ取り",avoid_defeat:"負けを避けるためにこう指してみるか",loss_almost_certain:"なにやっても負けそうなので好き勝手に指す",neutral:"いい手が思いつかなかったので、即負けしない範囲で好き勝手に指す"}}}},9447:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.drawArrow=o.drawCancelButton=o.drawHoverAt_=o.drawPhantomAt=o.eraseArrow=o.erasePhantomAndOptionallyCancelButton=o.eraseGuide=o.drawCiurl=o.animateWaterEntryLogo=o.animateStepTamLogo=o.animateNode=void 0;const n=t(892),r=t(4728),i=t(4495),a=t(8460),s=t(7421);function l(){const e=document.getElementById("contains_phantom");for(;e.firstChild;)e.removeChild(e.firstChild)}o.animateNode=async function(e,o,t,n="100",r){e.style.transition=`transform ${o/1e3}s ease`,e.style.zIndex=n,e.style.transform=`translateY(${t.to.top-t.from.top}px)`,e.style.transform+=`translateX(${t.to.left-t.from.left}px)`,null!=r&&(e.style.transform+=`rotate(${r}deg)`),await new Promise((e=>setTimeout(e,o)))},o.animateStepTamLogo=async function(){const e=document.getElementById("step_tam_logo");e.style.display="block",e.classList.add("step_tam");const o=document.getElementById("protective_cover_over_field_while_asyncawait");o.classList.remove("nocover"),setTimeout((()=>{e.style.display="none",o.classList.add("nocover")}),971.16),await new Promise((e=>setTimeout(e,1e3*.8093)))},o.animateWaterEntryLogo=async function(){const e=document.getElementById("water_entry_logo");e.style.display="block",e.classList.add("water_entry");const o=document.getElementById("protective_cover_over_field_while_asyncawait");o.classList.remove("nocover"),setTimeout((()=>{e.style.display="none",o.classList.add("nocover")}),971.16),await new Promise((e=>setTimeout(e,1e3*.8093)))},o.drawCiurl=function(e,o){const t=function(){let e=0,o=0;for(;0===e;)e=Math.random();for(;0===o;)o=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*o)},a=document.getElementById("contains_ciurl");(0,s.removeAllChildren)(document.getElementById("contains_ciurl"));const l=i.BOX_SIZE*(335/70+t()/6),c=84+(null==o||o===n.Side.Upward?771:0),d=e.map(((o,n)=>(0,r.createCiurl)(o,{left:l+.2*i.BOX_SIZE*t(),top:c+26*(n+.5-e.length/2)+.05*i.BOX_SIZE*t(),rotateDeg:40*Math.random()-20})));for(let e=d.length-1;e>0;e--){const o=Math.floor(Math.random()*(e+1));[d[e],d[o]]=[d[o],d[e]]}for(let e=0;e<d.length;e++)a.appendChild(d[e])},o.eraseGuide=function(){(0,s.removeAllChildren)(document.getElementById("contains_guides")),(0,s.removeAllChildren)(document.getElementById("contains_guides_on_upward"))},o.erasePhantomAndOptionallyCancelButton=l,o.eraseArrow=function(){(0,s.removeAllChildren)(document.getElementById("arrows"))},o.drawPhantomAt=function(e,o){const t=document.getElementById("contains_phantom");l();const n=(0,r.createPieceImgToBePlacedOnBoard)(e,o);n.style.opacity="0.1",t.appendChild(n)},o.drawHoverAt_=function(e,o,t){const n=document.getElementById("contains_phantom"),i=(0,r.createPieceSizeImageOnBoardByPath_Shifted)(e,(0,a.toPath_)(o),"piece_image_on_board");i.style.zIndex="100",i.style.cursor="pointer";const s=function(){t(e,o)};i.addEventListener("click",s),n.appendChild(i),s()},o.drawCancelButton=function(e){const o=document.getElementById("contains_phantom"),t=(0,r.createCancelButton)();t.width=80,t.height=80,t.style.zIndex="100",t.style.cursor="pointer",t.setAttribute("id","cancelButton"),t.addEventListener("click",e),o.appendChild(t)},o.drawArrow=function(e,o){const t=(()=>{if(e[1]===o[1]&&e[0]>o[0]){const t=e[0]-o[0];return`m31.6 ${51.3+i.BOX_SIZE*t}h5.8v${-(34.5+i.BOX_SIZE*t)}l-21.3 31 4.5 3.2 11-16z`}if(e[1]===o[1]&&e[0]<o[0]){const t=o[0]-e[0];return`m31.6 18.7h5.8v${34.5+i.BOX_SIZE*t}l-21.3-31 4.5-3.2 11 16z`}if(e[0]===o[0]&&e[1]>o[1]){const t=e[1]-o[1];return`m${51.3+i.BOX_SIZE*t} 31.6v5.8h${-(34.5+i.BOX_SIZE*t)}l31-21.3 3.2 4.5-16 11z`}if(e[0]===o[0]&&e[1]<o[1]){const t=o[1]-e[1];return`m18.7 31.6v5.8h${34.5+i.BOX_SIZE*t}l-31-21.3-3.2 4.5 16 11z`}if(e[0]>o[0]&&e[1]<o[1]&&e[0]-o[0]==o[1]-e[1]){const t=e[0]-o[0];return`m${32.9+i.BOX_SIZE*t} 34.8-19.8 5.6-1.8-5.9 41-10.7 ${-(32.4+i.BOX_SIZE*t)} ${32.4+i.BOX_SIZE*t}-4.2-4.2z`}if(e[0]<o[0]&&e[1]>o[1]&&e[0]-o[0]==o[1]-e[1]){const t=e[1]-o[1];return`m34.8 ${32.9+i.BOX_SIZE*t} 5.6-19.8-5.9-1.8-10.7 41 ${32.4+i.BOX_SIZE*t} ${-(32.4+i.BOX_SIZE*t)}-4.2-4.2z`}if(e[0]>o[0]&&e[1]>o[1]&&e[0]-o[0]==e[1]-o[1]){const t=e[1]-o[1];return`m34.8 37.1 5.6 19.8-5.9 1.8-10.7-41 ${32.4+i.BOX_SIZE*t} ${32.4+i.BOX_SIZE*t}-4.2 4.2z`}if(e[0]<o[0]&&e[1]<o[1]&&e[0]-o[0]==e[1]-o[1]){const t=o[0]-e[0];return`m${32.9+i.BOX_SIZE*t} ${35.2+i.BOX_SIZE*t}-19.8-5.6-1.8 5.9 41 10.7 ${-(32.4+i.BOX_SIZE*t)} ${-(32.4+i.BOX_SIZE*t)}-4.2 4.2z`}throw new Error("unsupported direction for the arrow")})(),n=[Math.min(e[0],o[0]),Math.min(e[1],o[1])];document.getElementById("arrows").appendChild((0,r.createArrowSvg)(t,n))}},2392:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.API_ORIGIN=void 0,o.API_ORIGIN="https://serene-reef-96808.herokuapp.com"},8513:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.GAME_STATE=o.initial_board_with_IA_down=o.fromAbsoluteCoord=o.toAbsoluteCoord=void 0;const n=t(892),r=t(4974),i=t(1849),a=t(892);o.toAbsoluteCoord=function(e){return(0,a.toAbsoluteCoord_)(e,o.GAME_STATE.IA_is_down)},o.fromAbsoluteCoord=function(e){return(0,a.fromAbsoluteCoord_)(e,o.GAME_STATE.IA_is_down)},o.initial_board_with_IA_down=[[{color:r.Color.Huok2,prof:r.Profession.Kua2,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Maun1,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Kaun1,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Uai1,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Io,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Uai1,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kaun1,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Maun1,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kua2,side:n.Side.Downward}],[{color:r.Color.Kok1,prof:r.Profession.Tuk2,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Gua2,side:n.Side.Downward},null,{color:r.Color.Kok1,prof:r.Profession.Dau2,side:n.Side.Downward},null,{color:r.Color.Huok2,prof:r.Profession.Dau2,side:n.Side.Downward},null,{color:r.Color.Huok2,prof:r.Profession.Gua2,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Tuk2,side:n.Side.Downward}],[{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Nuak1,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Downward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Downward}],[null,null,null,null,null,null,null,null,null],[null,null,null,null,"Tam2",null,null,null,null],[null,null,null,null,null,null,null,null,null],[{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Nuak1,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Kauk2,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Kauk2,side:n.Side.Upward}],[{color:r.Color.Huok2,prof:r.Profession.Tuk2,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Gua2,side:n.Side.Upward},null,{color:r.Color.Huok2,prof:r.Profession.Dau2,side:n.Side.Upward},null,{color:r.Color.Kok1,prof:r.Profession.Dau2,side:n.Side.Upward},null,{color:r.Color.Kok1,prof:r.Profession.Gua2,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Tuk2,side:n.Side.Upward}],[{color:r.Color.Kok1,prof:r.Profession.Kua2,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Maun1,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Kaun1,side:n.Side.Upward},{color:r.Color.Kok1,prof:r.Profession.Uai1,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Io,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Uai1,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Kaun1,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Maun1,side:n.Side.Upward},{color:r.Color.Huok2,prof:r.Profession.Kua2,side:n.Side.Upward}]],o.GAME_STATE=(e=>{let t=!0,r=20;const a=[[],[],[],[]];let s=0;return{last_move_focus:null,f:{currentBoard:e.IA_is_down?(0,n.rotateBoard)((0,n.rotateBoard)(o.initial_board_with_IA_down)):(0,n.rotateBoard)(o.initial_board_with_IA_down),hop1zuo1OfDownward:[],hop1zuo1OfUpward:[]},IA_is_down:e.IA_is_down,tam_itself_is_tam_hue:!0,opponent_has_just_moved_tam:!1,set is_my_turn(e){t=!!e,t?(document.getElementById("my_icon").style.opacity="1",document.getElementById("larta_opponent").style.opacity="0.3",document.getElementById("opponent_message").textContent="",document.getElementById("opponent_message_linzklar").textContent="",document.getElementById("protective_cover_over_field_while_waiting_for_opponent").classList.add("nocover")):(document.getElementById("my_icon").style.opacity="0.3",document.getElementById("larta_opponent").style.opacity="1",document.getElementById("protective_cover_over_field_while_waiting_for_opponent").classList.remove("nocover"),window.setTimeout(i.sendMainPollAndDoEverythingThatFollows,500*.8093))},get is_my_turn(){return t},backupDuringStepping:null,set my_score(e){a[s].push(e-r),r=e},get my_score(){return r},get season(){return s},set season(e){s=e},get scores_of_each_season(){return[a[0].concat([]),a[1].concat([]),a[2].concat([]),a[3].concat([])]},set scores_of_each_season(e){throw new Error("Cannot set scores_of_each_season. Please set my_score to reflect the change in the score.")},log2_rate:0}})({IA_is_down:(()=>{try{return JSON.parse(sessionStorage.is_IA_down_for_me)}catch{location.href="entrance.html"}})()})},4495:(e,o)=>{function t(e){return e.list_length<=9?e.ind:8*e.ind/(e.list_length-1)}Object.defineProperty(o,"__esModule",{value:!0}),o.getDenoteRateNodeTopLeft=o.getDenoteScoreNodeTopLeft=o.getDenoteSeasonNodeTopLeft=o.indToHo1Zuo1OfDownward=o.hop1_zuo1_left_position=o.coordToPieceXY_Shifted=o.coordToPieceXY=o.adjust_ind_for_hop1zuo1=o.PIECE_SIZE=o.MAX_PIECE_SIZE=o.BOX_SIZE=void 0,o.BOX_SIZE=70,o.MAX_PIECE_SIZE=o.BOX_SIZE-1,o.PIECE_SIZE=60,o.adjust_ind_for_hop1zuo1=t,o.coordToPieceXY=function(e){const[t,n]=e;return{top:1+t*o.BOX_SIZE+(o.MAX_PIECE_SIZE-o.PIECE_SIZE)/2,left:1+n*o.BOX_SIZE+(o.MAX_PIECE_SIZE-o.PIECE_SIZE)/2}},o.coordToPieceXY_Shifted=function(e){const[t,n]=e;return{top:1+t*o.BOX_SIZE+(o.MAX_PIECE_SIZE-o.PIECE_SIZE),left:1+n*o.BOX_SIZE}},o.hop1_zuo1_left_position=function(e){return 1+t(e)*o.BOX_SIZE+(o.MAX_PIECE_SIZE-o.PIECE_SIZE)/2},o.indToHo1Zuo1OfDownward=function(e){return{top:-135,left:1+e*o.BOX_SIZE+(o.MAX_PIECE_SIZE-o.PIECE_SIZE)/2}},o.getDenoteSeasonNodeTopLeft=function(e){return{top:360+51*(3-e),left:3}},o.getDenoteScoreNodeTopLeft=function(e){return{top:447+21.83333333333333*(20-e),left:65}},o.getDenoteRateNodeTopLeft=function(e){return{top:873-48.333333333333336*(e-1),left:4}}},4204:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.push_header_elem_and_display=o.push_body_elem_and_display=o.push_initial_colors_and_display=o.display_kiar_ark=void 0;const t={header:[],body:[],initial_colors:[]};function n(){console.log("_kiar_ark:",t),document.getElementById("kiar_ark").textContent=`{一位色:${t.initial_colors.join("")}}\n`+t.header.map((e=>e.dat)).join("\n")+"\n"+function(e){var o,t,n,r;let i="";for(let a=0;a<e.length;){const s=e[a],l=e[a+1];if("movement"===(null==s?void 0:s.type)&&"movement"===(null==l?void 0:l.type))i+=s.dat+(null!==(o=s.piece_capture_comment)&&void 0!==o?o:"")+"\t"+l.dat+(null!==(t=l.piece_capture_comment)&&void 0!==t?t:"")+"\n",a+=2;else if("tymoktaxot"===(null==s?void 0:s.type))i+="\n"+s.dat+"\n\n",a+=1;else if("movement"===(null==s?void 0:s.type)&&"tymoktaxot"===(null==l?void 0:l.type))i+=s.dat+(null!==(n=s.piece_capture_comment)&&void 0!==n?n:"")+"\n\n"+l.dat+"\n\n",a+=2;else{if("movement"!==(null==s?void 0:s.type)||void 0!==l)throw new Error(`Unexpected: the types passed to KIAR_ARK.body are "${null==s?void 0:s.type}" followed by "${null==l?void 0:l.type}".`);i+=s.dat+(null!==(r=s.piece_capture_comment)&&void 0!==r?r:"")+"\n",a+=1}}return i}(t.body)}o.display_kiar_ark=n,o.push_initial_colors_and_display=function(e){t.initial_colors.push(e),n()},o.push_body_elem_and_display=function(e){t.body.push(e),n()},o.push_header_elem_and_display=function(e){t.header.push(e),n()}},9090:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__setModuleDefault||(Object.create?function(e,o){Object.defineProperty(e,"default",{enumerable:!0,value:o})}:function(e,o){e.default=o}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var o={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(o,e,t);return r(o,e),o};Object.defineProperty(o,"__esModule",{value:!0}),o.selectOwnPieceOnHop1zuo1=o.selectOwnPieceOnBoard=o.drawCiurlWithAudio=void 0;const a=t(4728),s=t(8513),l=t(1849),c=t(892),d=t(8460),u=t(892),f=t(4495),_=t(2120),p=t(9798),m=t(5050),y=i(t(4204)),E=t(6548),w=t(9447),v=t(488),h=t(2327),A=t(9672);let T=null;function g(e){const o=b();return console.log("drawField #",1.1),(0,A.drawField)({focus:e}),o}function b(){(0,w.eraseGuide)(),(0,w.erasePhantomAndOptionallyCancelButton)(),document.getElementById("protective_cover_over_field").classList.add("nocover");const e=s.GAME_STATE.backupDuringStepping,o=e[0],t=e[1];return s.GAME_STATE.f.currentBoard[o[0]][o[1]]=t,s.GAME_STATE.backupDuringStepping=null,T=null,console.log("drawField #",1),(0,A.drawField)({focus:s.GAME_STATE.last_move_focus}),{piece_moved:t,maybe_capture:null}}function S(e,o,t){(0,w.eraseGuide)(),document.getElementById("protective_tam_cover_over_field").classList.remove("nocover"),document.getElementById("protective_cover_over_field").classList.add("nocover"),s.GAME_STATE.f.currentBoard[e[0]][e[1]]=null,s.GAME_STATE.f.currentBoard[o[0]][o[1]]="Tam2",console.log("drawField #",4.1),(0,A.drawField)({focus:null}),(0,w.drawPhantomAt)(e,"Tam2"),(0,w.drawCancelButton)((()=>{(0,w.eraseGuide)(),(0,w.erasePhantomAndOptionallyCancelButton)(),document.getElementById("protective_tam_cover_over_field").classList.add("nocover"),document.getElementById("protective_cover_over_field").classList.add("nocover"),s.GAME_STATE.f.currentBoard[o[0]][o[1]]=null,s.GAME_STATE.f.currentBoard[e[0]][e[1]]="Tam2",T=null,console.log("drawField #",5.1),(0,A.drawField)({focus:s.GAME_STATE.last_move_focus})})),function(o){const n=document.getElementById("contains_phantom"),r=(0,a.createPieceSizeImageOnBoardByPath)(o,(0,d.toPath_)("Tam2"),"piece_image_on_board");r.style.zIndex="100",r.style.cursor="pointer";const i=function(){const n=document.getElementById("contains_guides"),r=(0,a.createPieceSizeImageOnBoardByPath)(o,"selection2","selection");r.style.cursor="pointer",r.style.zIndex="200",n.appendChild(r);const{finite:i,infinite:l}=(0,u.calculateMovablePositions)(o,"Tam2",s.GAME_STATE.f.currentBoard,s.GAME_STATE.tam_itself_is_tam_hue);if(l.length>0)throw new Error("should not happen");for(let r=0;r<i.length;r++){const[l,c]=i[r],d=s.GAME_STATE.f.currentBoard[l][c];if(void 0!==t&&null!==d)continue;const f=(0,a.createGuideImageAt)(i[r],"yellow_diamond_for_tam");null===d?f.addEventListener("click",(()=>{const n=e,a=o,l=i[r];console.assert(null==s.GAME_STATE.f.currentBoard[l[0]][l[1]]);const c=t?{type:"TamMove",stepStyle:"StepsDuringFormer",src:(0,s.toAbsoluteCoord)(n),step:(0,s.toAbsoluteCoord)(t),firstDest:(0,s.toAbsoluteCoord)(a),secondDest:(0,s.toAbsoluteCoord)(l)}:{type:"TamMove",stepStyle:"NoStep",src:(0,s.toAbsoluteCoord)(n),firstDest:(0,s.toAbsoluteCoord)(a),secondDest:(0,s.toAbsoluteCoord)(l)};(0,w.erasePhantomAndOptionallyCancelButton)(),(0,w.eraseGuide)(),I(c),document.getElementById("protective_tam_cover_over_field").classList.add("nocover")})):f.addEventListener("click",(function(){var t,n,l;t=e,n=o,l=i[r],(0,w.eraseGuide)(),document.getElementById("protective_cover_over_field").classList.remove("nocover"),document.getElementById("protective_tam_cover_over_field").classList.remove("nocover"),s.GAME_STATE.backupDuringStepping=[n,"Tam2"],s.GAME_STATE.f.currentBoard[n[0]][n[1]]=null,document.getElementById("cancelButton").remove(),console.log("drawField #",2),(0,A.drawField)({focus:null}),(0,w.drawPhantomAt)(n,"Tam2"),(0,w.drawCancelButton)((()=>{(0,w.eraseGuide)(),(0,w.erasePhantomAndOptionallyCancelButton)(),document.getElementById("protective_cover_over_field").classList.add("nocover"),document.getElementById("protective_tam_cover_over_field").classList.add("nocover"),s.GAME_STATE.f.currentBoard[t[0]][t[1]]="Tam2",s.GAME_STATE.backupDuringStepping=null,T=null,console.log("drawField #",3.1),(0,A.drawField)({focus:s.GAME_STATE.last_move_focus})})),(0,w.drawHoverAt_)(l,"Tam2",((e,o)=>{const r=document.getElementById("contains_guides"),i=(0,a.createPieceSizeSelectionButtonOnBoard_Shifted)(e);r.appendChild(i);const{finite:c,infinite:d}=(0,u.calculateMovablePositions)(e,o,s.GAME_STATE.f.currentBoard,s.GAME_STATE.tam_itself_is_tam_hue);if(d.length>0)throw new Error("should not happen");for(let e=0;e<c.length;e++){const o=c[e],[i,d]=o;if(null!==s.GAME_STATE.f.currentBoard[i][d])continue;const u=(0,a.createGuideImageAt)(o,"yellow_diamond_for_tam");u.addEventListener("click",(function(){const e={type:"TamMove",stepStyle:"StepsDuringLatter",src:(0,s.toAbsoluteCoord)(t),step:(0,s.toAbsoluteCoord)(l),firstDest:(0,s.toAbsoluteCoord)(n),secondDest:(0,s.toAbsoluteCoord)(o)};(0,w.eraseGuide)(),(0,w.erasePhantomAndOptionallyCancelButton)(),I(e),document.getElementById("protective_cover_over_field").classList.add("nocover"),document.getElementById("protective_tam_cover_over_field").classList.add("nocover")})),u.style.zIndex="200",r.appendChild(u)}}))})),f.style.zIndex="200",n.appendChild(f)}};r.addEventListener("click",i),n.appendChild(r),i()}(o)}function P(e,o,t){(0,w.eraseGuide)(),document.getElementById("protective_cover_over_field").classList.remove("nocover"),s.GAME_STATE.backupDuringStepping=[e,o],s.GAME_STATE.f.currentBoard[e[0]][e[1]]=null,console.log("drawField #",6.1),(0,A.drawField)({focus:null}),(0,w.drawPhantomAt)(e,o),(0,w.drawCancelButton)(b),(0,w.drawHoverAt_)(t,o,(function(e,o){const t=document.getElementById("contains_guides"),n=(0,a.createPieceSizeSelectionButtonOnBoard_Shifted)(e);t.appendChild(n);const{finite:r,infinite:i}=(0,u.calculateMovablePositions)(e,o,s.GAME_STATE.f.currentBoard,s.GAME_STATE.tam_itself_is_tam_hue);if(L(e,{piece:o,path:"yellow_circle"},t,r),"Tam2"!==o)L(e,{piece:o,path:"green_circle"},t,i);else if(i.length>0)throw new Error("should not happen")}))}async function O(e,o){var t;const n=await M("`after half acceptance`",e,(e=>(console.log("Success; the server returned:",JSON.stringify(e)),e)));if("Err"===n.type)throw alert(`Illegal API sent, the reason being ${n.why_illegal}`),new Error(`Illegal API sent, the reason being ${n.why_illegal}`);if("WithoutWaterEntry"===n.type){(0,w.eraseGuide)(),T=null;const t=C(e,o.src,o.step),n=(()=>{if("Tam2"===t.piece_moved)throw new Error("Tam2 was passed to piece_moved");return(0,v.serializeProf)(t.piece_moved.prof)})();return console.log("drawField #",7),(0,A.drawField)({focus:s.GAME_STATE.last_move_focus}),s.GAME_STATE.is_my_turn=!1,void(e.dest?y.push_body_elem_and_display({type:"movement",dat:`${(0,v.serializeAbsoluteCoord)((0,s.toAbsoluteCoord)(o.src))}${n}${(0,v.serializeAbsoluteCoord)((0,s.toAbsoluteCoord)(o.step))}${(0,v.serializeAbsoluteCoord)(e.dest)}橋${(0,v.serializeCiurl)(o.stepping_ciurl)}`,piece_capture_comment:(0,h.toPieceCaptureComment)(t.maybe_capture)}):y.push_body_elem_and_display({type:"movement",dat:`${(0,v.serializeAbsoluteCoord)((0,s.toAbsoluteCoord)(o.src))}${n}${(0,v.serializeAbsoluteCoord)((0,s.toAbsoluteCoord)(o.step))}${(0,v.serializeAbsoluteCoord)(o.planned_destination)}橋${(0,v.serializeCiurl)(o.stepping_ciurl)}此無`,piece_capture_comment:(0,h.toPieceCaptureComment)(t.maybe_capture)}))}if(await(0,w.animateWaterEntryLogo)(),R(n.ciurl),await new Promise((e=>setTimeout(e,500*.8093))),n.ciurl.filter((e=>e)).length<3){alert(_.DICTIONARY.ja.failedWaterEntry),(0,w.eraseGuide)(),T=null;const r=g(o.src);s.GAME_STATE.is_my_turn=!1;const i=(()=>{const e=r.piece_moved;if("Tam2"===e)throw new Error("Tam2 encountered in the backup even though we are in sendAfterAcceptance");return(0,v.serializeProf)(e.prof)})(),a=null!==(t=e.dest)&&void 0!==t?t:(()=>{throw new Error("This should not happen; it should have been rejected before the water entry")})();y.push_body_elem_and_display({type:"movement",dat:`${(0,v.serializeAbsoluteCoord)((0,s.toAbsoluteCoord)(o.src))}${i}${(0,v.serializeAbsoluteCoord)((0,s.toAbsoluteCoord)(o.step))}${(0,v.serializeAbsoluteCoord)(a)}橋${(0,v.serializeCiurl)(o.stepping_ciurl)}水${(0,v.serializeCiurl)(n.ciurl)}此無`})}else{(0,w.eraseGuide)(),T=null;const t=C(e,o.src,o.step);console.log("drawField #",8),(0,A.drawField)({focus:s.GAME_STATE.last_move_focus}),s.GAME_STATE.is_my_turn=!1;const r=(()=>{if("Tam2"===t.piece_moved)throw new Error("Tam2 was passed to `piece_moved`");return(0,v.serializeProf)(t.piece_moved.prof)})();if(!e.dest)throw new Error("This should not happen; it should have been rejected before the water entry");y.push_body_elem_and_display({type:"movement",dat:`${(0,v.serializeAbsoluteCoord)((0,s.toAbsoluteCoord)(o.src))}${r}${(0,v.serializeAbsoluteCoord)((0,s.toAbsoluteCoord)(o.step))}${(0,v.serializeAbsoluteCoord)(e.dest)}橋${(0,v.serializeCiurl)(o.stepping_ciurl)}水${(0,v.serializeCiurl)(n.ciurl)}`,piece_capture_comment:(0,h.toPieceCaptureComment)(t.maybe_capture)})}}async function M(e,o,t){return await(0,A.sendStuffTo)("slow",e,o,t)}async function I(e){const o=await M("normal move",e,(e=>(console.log("Success; the server returned:",JSON.stringify(e)),e)));if("Err"===o.type)throw alert(`Illegal API sent, the reason being ${o.why_illegal}`),new Error(`Illegal API sent, the reason being ${o.why_illegal}`);if("WithoutWaterEntry"===o.type){(0,w.eraseGuide)(),T=null;const o=D(e);return console.log("drawField #",9),(0,A.drawField)({focus:s.GAME_STATE.last_move_focus}),s.GAME_STATE.is_my_turn=!1,void y.push_body_elem_and_display({type:"movement",dat:(0,v.normalMessageToKiarArk)(e,{piece_moved:o.piece_moved}),piece_capture_comment:(0,h.toPieceCaptureComment)(o.maybe_capture)})}if(await(0,w.animateWaterEntryLogo)(),R(o.ciurl),await new Promise((e=>setTimeout(e,500*.8093))),o.ciurl.filter((e=>e)).length<3){if(alert(_.DICTIONARY.ja.failedWaterEntry),(0,w.eraseGuide)(),T=null,"NonTamMove"===e.type&&"SrcStepDstFinite"===e.data.type){const t=g((0,s.fromAbsoluteCoord)(e.data.src));s.GAME_STATE.is_my_turn=!1,y.push_body_elem_and_display({type:"movement",dat:(0,v.normalMessageToKiarArk)(e,{water_ciurl_count:o.ciurl.filter((e=>e)).length,piece_moved:t.piece_moved})})}else if("NonTamMove"===e.type&&"FromHand"!==e.data.type){console.log("drawField #",10.1),(0,A.drawField)({focus:(0,s.fromAbsoluteCoord)(e.data.src)}),s.GAME_STATE.is_my_turn=!1;const[t,n]=(0,s.fromAbsoluteCoord)(e.data.src),r=s.GAME_STATE.f.currentBoard[t][n];if(null===r)throw new Error("Cannot happen");y.push_body_elem_and_display({type:"movement",dat:(0,v.normalMessageToKiarArk)(e,{water_ciurl_count:o.ciurl.filter((e=>e)).length,piece_moved:r})})}}else{(0,w.eraseGuide)(),T=null;const t=D(e);console.log("drawField #",10),(0,A.drawField)({focus:s.GAME_STATE.last_move_focus}),s.GAME_STATE.is_my_turn=!1,y.push_body_elem_and_display({type:"movement",dat:(0,v.normalMessageToKiarArk)(e,{piece_moved:t.piece_moved,water_ciurl_count:o.ciurl.filter((e=>e)).length}),piece_capture_comment:(0,h.toPieceCaptureComment)(t.maybe_capture)})}}function C(e,o,t){if(console.log(o,t),null===e.dest){const e=b();return console.log("lone assignment to last_move_focus, #",0),s.GAME_STATE.last_move_focus=o,{piece_moved:e.piece_moved,maybe_capture:null}}const[n,r]=(0,s.fromAbsoluteCoord)(e.dest),i=s.GAME_STATE.backupDuringStepping[1];b();const[a,l]=o,[d,u]=t;if(null===s.GAME_STATE.f.currentBoard[d][u])throw new Error("step is unoccupied");const f=s.GAME_STATE.f.currentBoard[n][r];return(0,c.coordEq)([a,l],[n,r])?(console.log("lone assignment to last_move_focus, #",1),s.GAME_STATE.last_move_focus=[a,l],{piece_moved:i,maybe_capture:null}):(null!==f&&N(f),s.GAME_STATE.f.currentBoard[a][l]=null,s.GAME_STATE.f.currentBoard[n][r]=i,console.log("lone assignment to last_move_focus, #",2),s.GAME_STATE.last_move_focus=[n,r],{piece_moved:i,maybe_capture:(0,h.toColorProf)(f)})}function N(e){const o=(()=>{if("Tam2"===e)throw new Error("dest is occupied by Tam2");if(e.side===c.Side.Upward)throw new Error("dest is occupied by an ally");if(e.side===c.Side.Downward)return{color:e.color,prof:e.prof,side:c.Side.Upward};throw e.side,new Error("should not reach here")})(),t=(0,A.calculateHandsAndScore)(s.GAME_STATE.f.hop1zuo1OfUpward);s.GAME_STATE.f.hop1zuo1OfUpward.push(o);const n=(0,A.calculateHandsAndScore)(s.GAME_STATE.f.hop1zuo1OfUpward);n.score!==t.score&&(setTimeout((()=>{(0,p.drawScoreDisplay)(n.hands);const e=n.score,o=document.getElementById("score_display"),t=(0,a.createImageButton)("再行",0);t.addEventListener("click",(async()=>{if((0,A.increaseRateAndAnimate)(!0),"Ok"!==(await(0,A.sendStuffTo)("whethertymok/tymok","`send whether ty mok1`",{},(e=>(console.log("Success; the server returned:",JSON.stringify(e)),e)))).type)throw new Error("bad!!!!");y.push_body_elem_and_display({type:"tymoktaxot",dat:`或為${n.hands.join("加")}\n再行`})})),o.appendChild(t);const r=(0,a.createImageButton)("終季",250);r.addEventListener("click",(async()=>{var o,t;const r=await(0,A.sendStuffTo)("whethertymok/taxot","`send whether ty mok1`",{},(e=>(console.log("Success; the server returned:",JSON.stringify(e)),e)));if("Ok"!==r.type)throw new Error("bad!!!!");const i=null!==(t=null===(o=r.is_first_move_my_move)||void 0===o?void 0:o.result)&&void 0!==t?t:null,a=["春","夏","秋","冬"][s.GAME_STATE.season];(0,A.endSeason)(e,i),y.push_body_elem_and_display({type:"tymoktaxot",dat:`或為${n.hands.join("加")}而手${(0,m.toDigitsLinzklar)(e*Math.pow(2,s.GAME_STATE.log2_rate)).join("")}\n終季\t${a}終`})})),o.appendChild(r)}),1e3*.8093),(0,l.forbidMainPolling)())}function D(e){if("NonTamMove"===e.type){if("FromHand"===e.data.type){const o=e.data,t=s.GAME_STATE.f.hop1zuo1OfUpward.findIndex((e=>e.color===o.color&&e.prof===o.prof));if(-1===t)throw new Error("What should exist in the hand does not exist");const[n]=s.GAME_STATE.f.hop1zuo1OfUpward.splice(t,1),[r,i]=(0,s.fromAbsoluteCoord)(o.dest);if(null!==s.GAME_STATE.f.currentBoard[r][i])throw new Error("Trying to parachute the piece onto an occupied space");return s.GAME_STATE.f.currentBoard[r][i]=n,console.log("lone assignment to last_move_focus, #",3),s.GAME_STATE.last_move_focus=[r,i],{piece_moved:n,maybe_capture:null}}if("SrcDst"===e.data.type){const o=e.data,[t,n]=(0,s.fromAbsoluteCoord)(o.src),[r,i]=(0,s.fromAbsoluteCoord)(o.dest),a=s.GAME_STATE.f.currentBoard[t][n];if(null===a)throw new Error("src is unoccupied");const l=s.GAME_STATE.f.currentBoard[r][i];return null!==l&&N(l),s.GAME_STATE.f.currentBoard[t][n]=null,s.GAME_STATE.f.currentBoard[r][i]=a,console.log("lone assignment to last_move_focus, #",4),s.GAME_STATE.last_move_focus=[r,i],{piece_moved:a,maybe_capture:(0,h.toColorProf)(l)}}if("SrcStepDstFinite"===e.data.type){const o=e.data,[t,n]=(0,s.fromAbsoluteCoord)(o.src),[r,i]=(0,s.fromAbsoluteCoord)(o.dest),a=s.GAME_STATE.backupDuringStepping[1];b();const[l,d]=(0,s.fromAbsoluteCoord)(o.step);if(null===s.GAME_STATE.f.currentBoard[l][d])throw new Error("step is unoccupied");const u=s.GAME_STATE.f.currentBoard[r][i];return(0,c.coordEq)([t,n],[r,i])?(s.GAME_STATE.last_move_focus=[r,i],console.log("lone assignment to last_move_focus, #",4.5),{piece_moved:a,maybe_capture:null}):(null!==u&&N(u),s.GAME_STATE.f.currentBoard[t][n]=null,s.GAME_STATE.f.currentBoard[r][i]=a,s.GAME_STATE.last_move_focus=[r,i],console.log("lone assignment to last_move_focus, #",5),{piece_moved:a,maybe_capture:(0,h.toColorProf)(u)})}throw e.data,new Error("should not reach here")}if("TamMove"===e.type){const o=e,[t,n]=(0,s.fromAbsoluteCoord)(o.firstDest),[r,i]=(0,s.fromAbsoluteCoord)(o.secondDest);if("StepsDuringLatter"===e.stepStyle)return s.GAME_STATE.f.currentBoard[r][i]="Tam2",s.GAME_STATE.last_move_focus=[r,i],console.log("lone assignment to last_move_focus, #",6),{piece_moved:"Tam2",maybe_capture:null};const a=s.GAME_STATE.f.currentBoard[t][n];if(null===a)throw new Error("firstDest is unoccupied");if("Tam2"!==a)throw new Error("TamMove but not Tam2");return(0,c.coordEq)([t,n],[r,i])?(s.GAME_STATE.last_move_focus=[r,i],console.log("lone assignment to last_move_focus, #",7),{piece_moved:"Tam2",maybe_capture:null}):(s.GAME_STATE.f.currentBoard[t][n]=null,s.GAME_STATE.f.currentBoard[r][i]=a,s.GAME_STATE.last_move_focus=[r,i],console.log("lone assignment to last_move_focus, #",8),{piece_moved:"Tam2",maybe_capture:null})}throw new Error("should not reach here")}function B(e,o,t,n){if(null!=s.GAME_STATE.f.currentBoard[t[0]][t[1]])(0,u.canGetOccupiedBy)(c.Side.Upward,t,e,s.GAME_STATE.f.currentBoard,s.GAME_STATE.tam_itself_is_tam_hue)&&n&&confirm(_.DICTIONARY.ja.whetherToTake)?I({type:"NonTamMove",data:{type:"SrcDst",src:(0,s.toAbsoluteCoord)(o),dest:(0,s.toAbsoluteCoord)(t)}}):P(o,e,t);else{let n;if("Tam2"!==e)return n={type:"NonTamMove",data:{type:"SrcDst",src:(0,s.toAbsoluteCoord)(o),dest:(0,s.toAbsoluteCoord)(t)}},void I(n);S(o,t)}}function k(e){const[o,t]=e;return"Tam2"===s.GAME_STATE.f.currentBoard[o][t]}function j(e,o,t,n){if("Tam2"===t)return void S(e,n,o);const r={type:"NonTamMove",data:{type:"SrcStepDstFinite",step:(0,s.toAbsoluteCoord)(o),dest:(0,s.toAbsoluteCoord)(n),src:(0,s.toAbsoluteCoord)(e)}};k(o)?(async()=>{await(0,w.animateStepTamLogo)(),await(0,A.animatePunishStepTamAndCheckPerzej)(c.Side.Upward),await I(r)})():I(r)}async function G(e,o){const t=await M("inf after step",e,(e=>(console.log("Success; the server returned:",JSON.stringify(e)),e)));if("Err"===t.type)throw alert(`Illegal API sent, the reason being ${t.why_illegal}`),new Error(`Illegal API sent, the reason being ${t.why_illegal}`);k((0,s.fromAbsoluteCoord)(e.step))&&(await(0,w.animateStepTamLogo)(),await(0,A.animatePunishStepTamAndCheckPerzej)(c.Side.Upward)),R(t.ciurl),document.getElementById("cancelButton").remove(),(0,w.eraseGuide)();const n=(0,s.fromAbsoluteCoord)(e.step),r=(0,s.fromAbsoluteCoord)(e.plannedDirection),i=(0,a.createPieceSizeImageOnBoardByPath_Shifted)(n,"selection2","selection");i.style.zIndex="200";const l=document.getElementById("contains_guides");l.appendChild(i);const d={color:o.color,prof:o.prof,side:c.Side.Upward},{infinite:f}=(0,u.calculateMovablePositions)(n,d,s.GAME_STATE.f.currentBoard,s.GAME_STATE.tam_itself_is_tam_hue),_=function(e,o,t,n){return e.filter((e=>{const r=function([e,t]){const[n,r]=o;return[e-n,t-r]},i=n.filter((e=>e)).length,[a,s]=r(e),[l,c]=r(t);return a*c-l*s==0&&a*l+s*c>0&&Math.max(Math.abs(a),Math.abs(s))<=i}))}(f,n,r,t.ciurl),p=(0,s.fromAbsoluteCoord)(e.src),m=(0,a.createGuideImageAt)(p,"yellow_circle");m.addEventListener("click",(function(o){(0,w.eraseGuide)(),O({type:"AfterHalfAcceptance",dest:null},{src:p,step:n,stepping_ciurl:t.ciurl,planned_destination:e.plannedDirection})})),m.style.zIndex="200",l.appendChild(m);for(let o=0;o<_.length;o++){const r=_[o];if((0,c.coordEq)(p,r))continue;if(!(0,u.canGetOccupiedByNonTam)(c.Side.Upward,r,s.GAME_STATE.f.currentBoard,s.GAME_STATE.tam_itself_is_tam_hue))continue;const i=(0,a.createGuideImageAt)(_[o],"green_circle");i.addEventListener("click",(function(o){O({type:"AfterHalfAcceptance",dest:(0,s.toAbsoluteCoord)(r)},{src:p,step:n,stepping_ciurl:t.ciurl,planned_destination:e.plannedDirection})})),i.style.zIndex="200",l.appendChild(i)}}function R(e,o){(0,w.drawCiurl)(e,o),E.KRUT_CRUOP&&new Audio("sound/ciurl4.ogg").play()}function L(e,o,t,n){const r=T;if(null==r)throw new Error("though stepping, null startpoint!!!!!");if("Hop1zuo1"===r[0])throw new Error("though stepping, hop1zuo1 startpoint!!!!!");for(let i=0;i<n.length;i++){if(!(0,u.canGetOccupiedBy)(c.Side.Upward,n[i],o.piece,s.GAME_STATE.f.currentBoard,s.GAME_STATE.tam_itself_is_tam_hue)){const[e,r]=n[i],l=s.GAME_STATE.f.currentBoard[e][r];if("Tam2"!==o.piece&&"Tam2"!==l&&null!==l&&l.side===c.Side.Downward){const e=(0,a.createGuideImageAt)(n[i],"守");e.style.zIndex="200",t.append(e)}continue}const l=(0,a.createGuideImageAt)(n[i],o.path);l.addEventListener("click","yellow_circle"===o.path?function(){(0,w.eraseGuide)(),j(r,e,o.piece,n[i])}:function(){(0,w.eraseGuide)(),G({type:"InfAfterStep",step:(0,s.toAbsoluteCoord)(e),plannedDirection:(0,s.toAbsoluteCoord)(n[i]),src:(0,s.toAbsoluteCoord)(r)},{color:o.piece.color,prof:o.piece.prof})}),l.style.zIndex="200",t.appendChild(l)}}o.drawCiurlWithAudio=R,o.selectOwnPieceOnBoard=function(e,o){if((0,w.eraseGuide)(),null!=T&&"Hop1zuo1"!==T[0]&&(0,c.coordEq)(T,e))T=null;else{T=e;const t=document.getElementById("contains_guides"),n=(0,a.createPieceSizeImageOnBoardByPath)(e,"selection2","selection");n.style.cursor="pointer",n.addEventListener("click",(function(){(0,w.eraseGuide)(),T=null})),t.appendChild(n);const{finite:r,infinite:i}=(0,u.calculateMovablePositions)(e,o,s.GAME_STATE.f.currentBoard,s.GAME_STATE.tam_itself_is_tam_hue);!function(e,o,t,n){for(let r=0;r<n.length;r++){const i=(0,a.createGuideImageAt)(n[r],"yellow_circle");i.addEventListener("click",(function(){(0,w.eraseGuide)(),B(o,e,n[r],!0)})),i.addEventListener("contextmenu",(function(t){(0,w.eraseGuide)(),t.preventDefault(),B(o,e,n[r],!1)})),t.appendChild(i)}}(e,o,t,[...r,...i])}},o.selectOwnPieceOnHop1zuo1=function(e,o,t){if((0,w.eraseGuide)(),null==T||"Hop1zuo1"!==T[0]||T[1]!==e){T=["Hop1zuo1",e];const n=document.getElementById("contains_guides_on_upward"),r=140,i=1+(f.MAX_PIECE_SIZE-f.PIECE_SIZE)/2,l=r-f.PIECE_SIZE-i,c=(0,a.createPieceSizeImageOnBoardByPathAndXY)(l,(0,f.hop1_zuo1_left_position)({ind:e,list_length:t}),"selection2","selection");c.style.cursor="pointer",c.addEventListener("click",(function(){(0,w.eraseGuide)(),T=null})),n.appendChild(c);const d=document.getElementById("contains_guides");for(let e=0;e<9;e++)for(let t=0;t<9;t++){const n=[e,t];if(null!=s.GAME_STATE.f.currentBoard[e][t])continue;const r=(0,a.createGuideImageAt)(n,"yellow_circle");r.addEventListener("click",(function(){if((0,w.eraseGuide)(),null!=s.GAME_STATE.f.currentBoard[n[0]][n[1]])throw alert("Cannot parachute onto an occupied square"),new Error("Cannot parachute onto an occupied square");const e=(0,s.toAbsoluteCoord)(n);I({type:"NonTamMove",data:{type:"FromHand",color:o.color,prof:o.prof,dest:e}})})),d.appendChild(r)}}else T=null}},6548:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__setModuleDefault||(Object.create?function(e,o){Object.defineProperty(e,"default",{enumerable:!0,value:o})}:function(e,o){e.default=o}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var o={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(o,e,t);return r(o,e),o};Object.defineProperty(o,"__esModule",{value:!0}),o.LORK_LIAR=o.LORK_LIAR_ENABLED=o.KRUT_CRUOP=void 0;const a=t(9672),s=t(8513),l=i(t(4204));document.getElementById("coord_annotation").src=`image/IA_is_down=${s.GAME_STATE.IA_is_down}.svg`,console.log("drawField #",0),(0,a.drawField)({focus:null}),l.push_header_elem_and_display({type:"header",dat:`{始時:${(new Date).toISOString()}}`});let c=!1;document.getElementById("coord_toggle_button").addEventListener("click",(()=>{c=!c,console.log("COORD_TOGGLE now set to",c),document.getElementById("coord_annotation").style.visibility=c?"visible":"hidden",document.getElementById("coord_toggle_button").src=c?"image/toggle/coord_toggle_active.png":"image/toggle/coord_toggle_inactive.png"})),o.KRUT_CRUOP=!0,document.getElementById("krut_cruop_button").addEventListener("click",(()=>{o.KRUT_CRUOP=!o.KRUT_CRUOP,console.log("KRUT_CRUOP now set to",o.KRUT_CRUOP),document.getElementById("krut_cruop_button").src=o.KRUT_CRUOP?"image/toggle/kut2_cuop2_active.png":"image/toggle/kut2_cuop2_inactive.png"}));const d=new Audio("sound/cetkaik_leti_duxe_.ogg");d.loop=!0;let u=!1;function f(){o.LORK_LIAR_ENABLED=!o.LORK_LIAR_ENABLED,!u&&o.LORK_LIAR_ENABLED&&(d.play(),u=!0),document.getElementById("lork_liar_button").src=o.LORK_LIAR_ENABLED?"image/toggle/lok1_lia1_active.png":"image/toggle/lok1_lia1_inactive.png",document.getElementById("volume_slidebar").disabled=!o.LORK_LIAR_ENABLED,d.volume=o.LORK_LIAR_ENABLED?o.LORK_LIAR/100:0}o.LORK_LIAR_ENABLED=!1,o.LORK_LIAR=Number(document.getElementById("volume_slidebar").value),d.volume=o.LORK_LIAR_ENABLED?o.LORK_LIAR/100:0,document.getElementById("lork_liar_button").addEventListener("click",f),document.getElementById("volume_slidebar").addEventListener("input",(()=>{o.LORK_LIAR=Number(document.getElementById("volume_slidebar").value),d.volume=o.LORK_LIAR_ENABLED?o.LORK_LIAR/100:0})),document.getElementById("kait_kaik_button").addEventListener("click",(()=>{document.getElementById("kait_kaik").classList.add("nocover"),s.GAME_STATE.is_my_turn=JSON.parse(sessionStorage.is_first_move_my_move),l.push_initial_colors_and_display(s.GAME_STATE.is_my_turn===s.GAME_STATE.IA_is_down?"黒":"赤"),o.LORK_LIAR_ENABLED||f()})),"cpu"===sessionStorage.vs?document.getElementById("opponent_icon").innerHTML='<img src="image/nystiper2.png">':"someone"===sessionStorage.vs?document.getElementById("opponent_icon").innerHTML='<img src="image/larta2.png">':location.href="entrance.html"},1849:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return o[t]}})}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),r=this&&this.__setModuleDefault||(Object.create?function(e,o){Object.defineProperty(e,"default",{enumerable:!0,value:o})}:function(e,o){e.default=o}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var o={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(o,e,t);return r(o,e),o};Object.defineProperty(o,"__esModule",{value:!0}),o.sendMainPollAndDoEverythingThatFollows=o.allowMainPolling=o.forbidMainPolling=void 0;const a=t(892),s=t(8513),l=t(4495),c=t(9672),d=t(9447),u=t(2120),f=t(9798),_=i(t(4204)),p=t(5050),m=t(6548),y=t(488),E=t(2327),{forbidMainPolling:w,isMainPollingAllowed:v,allowMainPolling:h}=(()=>{let e=!0;return{forbidMainPolling:()=>{e=!1},isMainPollingAllowed:()=>e,allowMainPolling:()=>{e=!0}}})();function A(){return s.GAME_STATE.f.hop1zuo1OfDownward.length<=8?{top:-135,left:1+s.GAME_STATE.f.hop1zuo1OfDownward.length*l.BOX_SIZE+(l.MAX_PIECE_SIZE-l.PIECE_SIZE)/2}:{top:-135,left:1+9*l.BOX_SIZE+(l.MAX_PIECE_SIZE-l.PIECE_SIZE)/2}}function T(e){const o=(()=>{if("Tam2"===e)throw new Error("tried to convert Tam2 into downward");if(e.side===a.Side.Downward)throw new Error("tried to convert an already downward piece to downward");if(e.side===a.Side.Upward)return{color:e.color,prof:e.prof,side:a.Side.Downward};throw e.side,new Error("should not reach here")})(),t=(0,c.calculateHandsAndScore)(s.GAME_STATE.f.hop1zuo1OfDownward);s.GAME_STATE.f.hop1zuo1OfDownward.push(o);const n=(0,c.calculateHandsAndScore)(s.GAME_STATE.f.hop1zuo1OfDownward);n.score!==t.score&&(document.getElementById("protective_cover_over_field_while_waiting_for_opponent").classList.remove("nocover"),document.getElementById("protective_cover_over_field_while_asyncawait").classList.remove("nocover"),window.setTimeout((async()=>{await g(n)}),0),window.setTimeout((()=>{(0,f.drawScoreDisplay)(n.hands)}),1e3*.8093))}async function g(e){var o,t;const n=e.score;console.log("poll whether ty mok1 or ta xot1");const r=await(0,c.sendStuffTo)("whethertymokpoll","`polling for whether the declaration is ty mok1 or ta xot1`",{},(e=>(console.log("Success; the server returned:",JSON.stringify(e)),e)));if("Err"===r.type)throw alert(`sending TyMok1OrTaXot1Poll somehow resulted in an error: ${r.why_illegal}`),new Error(`sending TyMok1OrTaXot1Poll somehow resulted in an error: ${r.why_illegal}`);if("NotYetDetermined"!==r.type){console.log("ding!");const i=document.getElementById("score_display");for(await new Promise((e=>setTimeout(e,242.79)));!i.hasChildNodes();)await new Promise((e=>setTimeout(e,80.93)));if("TyMok"===r.type)i.innerHTML+='<img src="image/再行.png" style="position: absolute; left: 660px; top: 125px; " height="200">',await new Promise((e=>setTimeout(e,4046.5))),console.log("go on with ty mok1"),(0,c.increaseRateAndAnimate)(!1),_.push_body_elem_and_display({type:"tymoktaxot",dat:`或為${e.hands.join("加")}\n再行`});else{i.innerHTML+='<img src="image/終季.png" style="position: absolute; left: 660px; top: 125px; " height="200">',await new Promise((e=>setTimeout(e,4046.5))),console.log("go on with ta xot1");const a=["春","夏","秋","冬"][s.GAME_STATE.season];(0,c.endSeason)(-n,null!==(t=null===(o=r.is_first_move_my_move)||void 0===o?void 0:o.result)&&void 0!==t?t:null),_.push_body_elem_and_display({type:"tymoktaxot",dat:`或為${e.hands.join("加")}而手${(0,p.toDigitsLinzklar)(n*Math.pow(2,s.GAME_STATE.log2_rate)).join("")}\n終季\t${a}終`})}}else document.getElementById("protective_cover_over_field_while_waiting_for_opponent").classList.remove("nocover"),await new Promise((e=>setTimeout(e,500*.8093))),await g(e)}async function b(e,o,t,n){const[r,i]=e,[f,_]=o,[p,m]=t,y=s.GAME_STATE.f.currentBoard[r][i];if(null===y)throw new Error("src is unoccupied");const w=s.GAME_STATE.f.currentBoard[f][_];if(null===w)throw new Error("step is unoccupied");"Tam2"===w&&(await(0,d.animateStepTamLogo)(),await(0,c.animatePunishStepTamAndCheckPerzej)(a.Side.Downward));const v=s.GAME_STATE.f.currentBoard[p][m];if(null===v||(0,a.coordEq)(e,t)){const f=document.getElementById(`field_piece_${r}_${i}`);return await(0,d.animateNode)(f,606.975,{to:(0,l.coordToPieceXY_Shifted)(o),from:(0,l.coordToPieceXY)(e)}),await new Promise((e=>setTimeout(e,242.79))),await(0,d.animateNode)(f,606.975,{to:(0,l.coordToPieceXY)(t),from:(0,l.coordToPieceXY)(e)}),n&&(await(0,d.animateWaterEntryLogo)(),(0,d.drawCiurl)(n,a.Side.Downward),await new Promise((e=>setTimeout(e,500*.8093))),n.filter((e=>e)).length<3)?(alert(u.DICTIONARY.ja.failedWaterEntry),console.log("drawField opponent #",18),s.GAME_STATE.last_move_focus=[r,i],(0,c.drawField)({focus:[r,i]}),{piece_moved:y,maybe_capture:null}):((0,a.coordEq)(e,t)||(s.GAME_STATE.f.currentBoard[r][i]=null,s.GAME_STATE.f.currentBoard[p][m]=y),console.log("drawField opponent #",19),s.GAME_STATE.last_move_focus=[p,m],(0,c.drawField)({focus:[p,m]}),{piece_moved:y,maybe_capture:(0,a.coordEq)(e,t)?null:(0,E.toColorProf)(v)})}{const f=document.getElementById(`field_piece_${r}_${i}`),_=document.getElementById(`field_piece_${p}_${m}`);return await(0,d.animateNode)(f,606.975,{to:(0,l.coordToPieceXY_Shifted)(o),from:(0,l.coordToPieceXY)(e)}),await new Promise((e=>setTimeout(e,242.79))),await(0,d.animateNode)(f,606.975,{to:(0,l.coordToPieceXY)(t),from:(0,l.coordToPieceXY)(e)}),await new Promise((e=>setTimeout(e,242.79))),await(0,d.animateNode)(_,606.975,{to:A(),from:(0,l.coordToPieceXY)([p,m])},"50",180),n&&(await(0,d.animateWaterEntryLogo)(),(0,d.drawCiurl)(n,a.Side.Downward),await new Promise((e=>setTimeout(e,500*.8093))),n.filter((e=>e)).length<3)?(alert(u.DICTIONARY.ja.failedWaterEntry),console.log("drawField opponent #",16),s.GAME_STATE.last_move_focus=[r,i],(0,c.drawField)({focus:[r,i]}),{piece_moved:y,maybe_capture:null}):((0,a.coordEq)(e,t)||(T(v),s.GAME_STATE.f.currentBoard[r][i]=null,s.GAME_STATE.f.currentBoard[p][m]=y),console.log("drawField opponent #",17),s.GAME_STATE.last_move_focus=[p,m],(0,c.drawField)({focus:[p,m]}),{piece_moved:y,maybe_capture:(0,a.coordEq)(e,t)?null:(0,E.toColorProf)(v)})}}async function S(e,o,t){const[n,r]=e,[i,f]=o,_=s.GAME_STATE.f.currentBoard[n][r];if(null===_)throw new Error("src is unoccupied");const p=s.GAME_STATE.f.currentBoard[i][f];if(null!==p){const e=document.getElementById(`field_piece_${n}_${r}`),o=document.getElementById(`field_piece_${i}_${f}`),m=606.975;if(await(0,d.animateNode)(e,m,{to:(0,l.coordToPieceXY)([i,f]),from:(0,l.coordToPieceXY)([n,r])}),await(0,d.animateNode)(o,m,{to:A(),from:(0,l.coordToPieceXY)([i,f])},"50",180),t.water_entry_ciurl&&(await(0,d.animateWaterEntryLogo)(),(0,d.drawCiurl)(t.water_entry_ciurl,a.Side.Downward),await new Promise((e=>setTimeout(e,500*.8093))),t.water_entry_ciurl.filter((e=>e)).length<3))return alert(u.DICTIONARY.ja.failedWaterEntry),console.log("drawField opponent #",20),s.GAME_STATE.last_move_focus=[n,r],(0,c.drawField)({focus:[n,r]}),{piece_moved:_,maybe_capture:null};T(p),s.GAME_STATE.f.currentBoard[n][r]=null,s.GAME_STATE.f.currentBoard[i][f]=_,console.log("drawField opponent #",21),s.GAME_STATE.last_move_focus=[i,f],(0,c.drawField)({focus:[i,f]})}else{const e=document.getElementById(`field_piece_${n}_${r}`);if(await(0,d.animateNode)(e,1213.95,{to:(0,l.coordToPieceXY)([i,f]),from:(0,l.coordToPieceXY)([n,r])}),t.water_entry_ciurl&&(await(0,d.animateWaterEntryLogo)(),(0,d.drawCiurl)(t.water_entry_ciurl,a.Side.Downward),await new Promise((e=>setTimeout(e,500*.8093))),t.water_entry_ciurl.filter((e=>e)).length<3))return alert(u.DICTIONARY.ja.failedWaterEntry),console.log("drawField opponent #",22),s.GAME_STATE.last_move_focus=[n,r],(0,c.drawField)({focus:[n,r]}),{piece_moved:_,maybe_capture:null};s.GAME_STATE.f.currentBoard[n][r]=null,s.GAME_STATE.f.currentBoard[i][f]=_,t.disable_focus?(0,c.drawField)({focus:null}):(console.log("drawField opponent #",23),s.GAME_STATE.last_move_focus=[i,f],(0,c.drawField)({focus:[i,f]}))}return{piece_moved:_,maybe_capture:(0,E.toColorProf)(p)}}o.forbidMainPolling=w,o.allowMainPolling=h,o.sendMainPollAndDoEverythingThatFollows=async function e(){if(console.log("poll"),!v())return;const o=await async function(){const e=await(0,c.sendStuffTo)("mainpoll","`polling for the opponent's move`",{},(e=>(console.log("Success; the server returned:",JSON.stringify(e)),e)));if("Err"===e.type)throw alert(`sending MainPoll somehow resulted in an error: ${e.why_illegal}`),new Error(`sending MainPoll somehow resulted in an error: ${e.why_illegal}`);return e}();if("NotYetDetermined"===o.type)return await new Promise((e=>setTimeout(e,500*.8093))),void await e();console.log("ding!"),document.getElementById("opponent_message").textContent=null!=o.message?u.DICTIONARY.ja.tactics[o.message]:"",document.getElementById("opponent_message_linzklar").textContent=null!=o.message?u.TACTICS_LINZKLAR[o.message]:"",m.KRUT_CRUOP&&new Audio("sound/thud.ogg").play();const t=o.content;if(console.log(t),"NonTamMove"===t.type)if(s.GAME_STATE.opponent_has_just_moved_tam=!1,"SrcDst"===t.data.type){const e=await async function(e){const o=(0,s.fromAbsoluteCoord)(e.src),t=(0,s.fromAbsoluteCoord)(e.dest);return e.water_entry_ciurl?await S(o,t,{water_entry_ciurl:e.water_entry_ciurl}):await S(o,t,{})}(t.data),o=e.piece_moved;s.GAME_STATE.is_my_turn=!0,t.data.water_entry_ciurl?_.push_body_elem_and_display({type:"movement",dat:(0,y.normalMessageToKiarArk)(t,{piece_moved:o,water_ciurl_count:t.data.water_entry_ciurl.filter((e=>e)).length}),piece_capture_comment:(0,E.toPieceCaptureComment)(e.maybe_capture)}):_.push_body_elem_and_display({type:"movement",dat:(0,y.normalMessageToKiarArk)(t,{piece_moved:o}),piece_capture_comment:(0,E.toPieceCaptureComment)(e.maybe_capture)})}else if("FromHand"===t.data.type){const e={prof:t.data.prof,color:t.data.color,side:a.Side.Downward};await async function(e,o){const t=s.GAME_STATE.f.hop1zuo1OfDownward.findIndex((o=>o.color===e.color&&o.prof===e.prof));if(-1===t)throw new Error("What should exist in the hand does not exist");const[n]=s.GAME_STATE.f.hop1zuo1OfDownward.splice(t,1),[r,i]=o;if(null!==s.GAME_STATE.f.currentBoard[r][i])throw new Error("Trying to parachute the piece onto an occupied space");const a=document.getElementById(`hop1zuo1OfDownward_${t}`);await(0,d.animateNode)(a,1213.95,{to:(0,l.coordToPieceXY)([r,i]),from:{top:-135,left:(0,l.hop1_zuo1_left_position)({ind:t,list_length:s.GAME_STATE.f.hop1zuo1OfDownward.length})}}),s.GAME_STATE.f.currentBoard[r][i]=n,console.log("drawField opponent #",24),s.GAME_STATE.last_move_focus=[r,i],(0,c.drawField)({focus:[r,i]})}(e,(0,s.fromAbsoluteCoord)(t.data.dest)),s.GAME_STATE.is_my_turn=!0,_.push_body_elem_and_display({type:"movement",dat:(0,y.normalMessageToKiarArk)(t,{piece_moved:e})})}else{if("SrcStepDstFinite"!==t.data.type)throw t.data,new Error("does not happen");{const e=await async function(e){return await b((0,s.fromAbsoluteCoord)(e.src),(0,s.fromAbsoluteCoord)(e.step),(0,s.fromAbsoluteCoord)(e.dest),e.water_entry_ciurl)}(t.data),o=e.piece_moved;s.GAME_STATE.is_my_turn=!0,t.data.water_entry_ciurl?_.push_body_elem_and_display({type:"movement",dat:(0,y.normalMessageToKiarArk)(t,{piece_moved:o,water_ciurl_count:t.data.water_entry_ciurl.filter((e=>e)).length}),piece_capture_comment:(0,E.toPieceCaptureComment)(e.maybe_capture)}):_.push_body_elem_and_display({type:"movement",dat:(0,y.normalMessageToKiarArk)(t,{piece_moved:o}),piece_capture_comment:(0,E.toPieceCaptureComment)(e.maybe_capture)})}}else if("TamMove"===t.type)if(s.GAME_STATE.opponent_has_just_moved_tam=!0,"NoStep"===t.stepStyle)await async function(e,o,t){const n=s.GAME_STATE.f.currentBoard[e[0]][e[1]];if(null===n)throw new Error("src is unoccupied");const r=document.getElementById(`field_piece_${e[0]}_${e[1]}`);await(0,d.animateNode)(r,1213.95,{to:(0,l.coordToPieceXY)(o),from:(0,l.coordToPieceXY)(e)}),s.GAME_STATE.f.currentBoard[e[0]][e[1]]=null,s.GAME_STATE.f.currentBoard[o[0]][o[1]]=n,console.log("drawField opponent #",25),(0,c.drawField)({focus:null});const i=document.getElementById(`field_piece_${o[0]}_${o[1]}`);await new Promise((e=>setTimeout(e,242.79))),await(0,d.animateNode)(i,1213.95,{to:(0,l.coordToPieceXY)(t),from:(0,l.coordToPieceXY)(o)}),s.GAME_STATE.f.currentBoard[o[0]][o[1]]=null,s.GAME_STATE.f.currentBoard[t[0]][t[1]]=n,console.log("drawField opponent #",26),s.GAME_STATE.last_move_focus=[t[0],t[1]],(0,c.drawField)({focus:[t[0],t[1]]})}((0,s.fromAbsoluteCoord)(t.src),(0,s.fromAbsoluteCoord)(t.firstDest),(0,s.fromAbsoluteCoord)(t.secondDest)),s.GAME_STATE.is_my_turn=!0,_.push_body_elem_and_display({type:"movement",dat:(0,y.normalMessageToKiarArk)(t,{piece_moved:"Tam2"})});else if("StepsDuringFormer"===t.stepStyle)await async function(e){const o={src:(0,s.fromAbsoluteCoord)(e.src),firstDest:(0,s.fromAbsoluteCoord)(e.firstDest),secondDest:(0,s.fromAbsoluteCoord)(e.secondDest),step:(0,s.fromAbsoluteCoord)(e.step)};await b(o.src,o.step,o.firstDest),await new Promise((e=>setTimeout(e,242.79))),await S(o.firstDest,o.secondDest,{})}(t),s.GAME_STATE.is_my_turn=!0,_.push_body_elem_and_display({type:"movement",dat:(0,y.normalMessageToKiarArk)(t,{piece_moved:"Tam2"})});else{if("StepsDuringLatter"!==t.stepStyle)throw t.stepStyle,new Error("does not happen");await async function(e){const o={src:(0,s.fromAbsoluteCoord)(e.src),firstDest:(0,s.fromAbsoluteCoord)(e.firstDest),secondDest:(0,s.fromAbsoluteCoord)(e.secondDest),step:(0,s.fromAbsoluteCoord)(e.step)};await S(o.src,o.firstDest,{disable_focus:!0}),await new Promise((e=>setTimeout(e,242.79))),await b(o.firstDest,o.step,o.secondDest)}(t),s.GAME_STATE.is_my_turn=!0,_.push_body_elem_and_display({type:"movement",dat:(0,y.normalMessageToKiarArk)(t,{piece_moved:"Tam2"})})}else{if("InfAfterStep"!==t.type)throw new Error("does not happen");{s.GAME_STATE.opponent_has_just_moved_tam=!1;const e=(async()=>{if(null!=t.finalResult)return t.finalResult;for(;;){const e=await(0,c.sendStuffTo)("infpoll","`polling for the opponent's afterhalfacceptance`",{},(e=>(console.log("Success; the server returned:",JSON.stringify(e)),e)));if("Err"===e.type)throw new Error("not good!!!");if("NotYetDetermined"!==e.type){if("InfAfterStep"!==e.content.type)throw new Error("nooooooo");return e.content.finalResult}}})(),[o,n]=await async function(e){const[o,t]=e.src,[n,r]=e.step,i=s.GAME_STATE.f.currentBoard[o][t];if(null===i)throw new Error("src is unoccupied");const f=s.GAME_STATE.f.currentBoard[n][r];if(null===f)throw new Error("step is unoccupied");"Tam2"===f&&(await(0,d.animateStepTamLogo)(),await(0,c.animatePunishStepTamAndCheckPerzej)(a.Side.Downward));const _=document.getElementById(`field_piece_${o}_${t}`);await(0,d.animateNode)(_,606.975,{to:(0,l.coordToPieceXY_Shifted)(e.step),from:(0,l.coordToPieceXY)(e.src)}),await new Promise((e=>setTimeout(e,242.79))),await async function(e,o,t){(0,d.drawArrow)(e,o),await new Promise((e=>setTimeout(e,2e3*.8093))),(0,d.drawCiurl)(t,a.Side.Downward),await new Promise((e=>setTimeout(e,485.58))),(0,d.eraseArrow)()}(e.step,e.plannedDirection,e.stepping_ciurl);const p=await e.finalResult,m=(0,s.fromAbsoluteCoord)(p.dest),[y,w]=m,v=s.GAME_STATE.f.currentBoard[y][w];if(null===v||(0,a.coordEq)(e.src,m)){if(await(0,d.animateNode)(_,606.975,{to:(0,l.coordToPieceXY)(m),from:(0,l.coordToPieceXY)(e.src)}),p.water_entry_ciurl){if(await(0,d.animateWaterEntryLogo)(),(0,d.drawCiurl)(p.water_entry_ciurl,a.Side.Downward),await new Promise((e=>setTimeout(e,500*.8093))),p.water_entry_ciurl.filter((e=>e)).length<3)return alert(u.DICTIONARY.ja.failedWaterEntry),console.log("drawField opponent #",14),s.GAME_STATE.last_move_focus=[o,t],(0,c.drawField)({focus:[o,t]}),[p,{piece_moved:i,maybe_capture:null}]}else if(p.thwarted_by_failing_water_entry_ciurl)return await(0,d.animateWaterEntryLogo)(),(0,d.drawCiurl)(p.thwarted_by_failing_water_entry_ciurl,a.Side.Downward),await new Promise((e=>setTimeout(e,500*.8093))),alert(u.DICTIONARY.ja.failedWaterEntry),console.log("drawField opponent #",14),s.GAME_STATE.last_move_focus=[o,t],(0,c.drawField)({focus:[o,t]}),[p,{piece_moved:i,maybe_capture:null}];return(0,a.coordEq)(e.src,m)||(s.GAME_STATE.f.currentBoard[o][t]=null,s.GAME_STATE.f.currentBoard[y][w]=i),console.log("drawField opponent #",15),s.GAME_STATE.last_move_focus=[y,w],(0,c.drawField)({focus:[y,w]}),[p,{piece_moved:i,maybe_capture:null}]}{const n=document.getElementById(`field_piece_${y}_${w}`);return await(0,d.animateNode)(_,606.975,{to:(0,l.coordToPieceXY)(m),from:(0,l.coordToPieceXY)(e.src)}),await new Promise((e=>setTimeout(e,242.79))),await(0,d.animateNode)(n,606.975,{to:A(),from:(0,l.coordToPieceXY)([y,w])},"50",180),p.water_entry_ciurl&&(await(0,d.animateWaterEntryLogo)(),(0,d.drawCiurl)(p.water_entry_ciurl,a.Side.Downward),await new Promise((e=>setTimeout(e,500*.8093))),p.water_entry_ciurl.filter((e=>e)).length<3)?(alert(u.DICTIONARY.ja.failedWaterEntry),console.log("drawField opponent #",12),s.GAME_STATE.last_move_focus=[o,t],(0,c.drawField)({focus:[o,t]}),[p,{piece_moved:i,maybe_capture:null}]):((0,a.coordEq)(e.src,m)||(T(v),s.GAME_STATE.f.currentBoard[o][t]=null,s.GAME_STATE.f.currentBoard[y][w]=i),console.log("drawField opponent #",13),s.GAME_STATE.last_move_focus=[y,w],(0,c.drawField)({focus:[y,w]}),[p,{piece_moved:i,maybe_capture:(0,E.toColorProf)(v)}])}}({src:(0,s.fromAbsoluteCoord)(t.src),step:(0,s.fromAbsoluteCoord)(t.step),plannedDirection:(0,s.fromAbsoluteCoord)(t.plannedDirection),stepping_ciurl:t.stepping_ciurl,finalResult:e}),r=(()=>{if("Tam2"===n.piece_moved)throw new Error("Tam2 was passed to `piece_moved`");return(0,y.serializeProf)(n.piece_moved.prof)})();if(s.GAME_STATE.is_my_turn=!0,o.water_entry_ciurl)o.water_entry_ciurl.filter((e=>e)).length<3?_.push_body_elem_and_display({type:"movement",dat:`${(0,y.serializeAbsoluteCoord)(t.src)}${r}${(0,y.serializeAbsoluteCoord)(t.step)}${(0,y.serializeAbsoluteCoord)(o.dest)}橋${(0,y.serializeCiurl)(t.stepping_ciurl)}水${(0,y.serializeCiurl)(o.water_entry_ciurl)}此無`}):_.push_body_elem_and_display({type:"movement",dat:`${(0,y.serializeAbsoluteCoord)(t.src)}${r}${(0,y.serializeAbsoluteCoord)(t.step)}${(0,y.serializeAbsoluteCoord)(o.dest)}橋${(0,y.serializeCiurl)(t.stepping_ciurl)}水${(0,y.serializeCiurl)(o.water_entry_ciurl)}`,piece_capture_comment:(0,E.toPieceCaptureComment)(n.maybe_capture)});else if(o.thwarted_by_failing_water_entry_ciurl)_.push_body_elem_and_display({type:"movement",dat:`${(0,y.serializeAbsoluteCoord)(t.src)}${r}${(0,y.serializeAbsoluteCoord)(t.step)}${(0,y.serializeAbsoluteCoord)(o.dest)}橋${(0,y.serializeCiurl)(t.stepping_ciurl)}水${(0,y.serializeCiurl)(o.thwarted_by_failing_water_entry_ciurl)}此無`,piece_capture_comment:(0,E.toPieceCaptureComment)(n.maybe_capture)});else{const e=(e,o)=>e[0]===o[0]&&e[1]===o[1];e(t.plannedDirection,o.dest)||!e(o.dest,t.src)?_.push_body_elem_and_display({type:"movement",dat:`${(0,y.serializeAbsoluteCoord)(t.src)}${r}${(0,y.serializeAbsoluteCoord)(t.step)}${(0,y.serializeAbsoluteCoord)(o.dest)}橋${(0,y.serializeCiurl)(t.stepping_ciurl)}`,piece_capture_comment:(0,E.toPieceCaptureComment)(n.maybe_capture)}):_.push_body_elem_and_display({type:"movement",dat:`${(0,y.serializeAbsoluteCoord)(t.src)}${r}${(0,y.serializeAbsoluteCoord)(t.step)}${(0,y.serializeAbsoluteCoord)(t.plannedDirection)}橋${(0,y.serializeCiurl)(t.stepping_ciurl)}此無`,piece_capture_comment:(0,E.toPieceCaptureComment)(n.maybe_capture)})}}}}},8460:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toPath_=o.toPath=void 0;const n=t(4974),r=t(892);function i(e){return`${i=e.side,i===r.Side.Downward?"piece_rev":i===r.Side.Upward?"piece":i}/${t=e.color,t===n.Color.Huok2?"b":t===n.Color.Kok1?"r":t}${o=e.prof,o===n.Profession.Dau2?"dau":o===n.Profession.Gua2?"gua":o===n.Profession.Io?"io":o===n.Profession.Kauk2?"kauk":o===n.Profession.Kaun1?"kaun":o===n.Profession.Kua2?"kua":o===n.Profession.Maun1?"maun":o===n.Profession.Nuak1?"nuak":o===n.Profession.Tuk2?"tuk":o===n.Profession.Uai1?"uai":o}`;var o,t,i}o.toPath=i,o.toPath_=function(e){return"Tam2"===e?"piece/tam":i(e)}},9798:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.drawScoreDisplay=o.drawFinalScoreDisplay=void 0;const n=t(8431),r=t(4728),i=t(7421),a=t(5050);function s(e,o){return e.map(((e,t)=>{const n=document.createElement("img");return n.src=`image/digit/${e}.png`,n.style.position="absolute",n.style.left=`${o.left}px`,n.style.top=`${.94*o.width*t+o.top}px`,n.width=o.width,n}))}function l(e){const o=(0,a.toDigitsLinzklar)(e);return s(o,{left:20,top:234-70*o.length/2,width:70})}o.drawFinalScoreDisplay=function(e){const o=e=>s((0,a.toDigitsLinzklar)(e.score),{left:530-60*e.column_index,top:23.5*(2-(0,a.toDigitsLinzklar)(e.score).length)+239,width:50}),t=[].concat(...e),n=20+t.reduce(((e,o)=>e+o),0),r=document.getElementById("final_score_display");r.classList.remove("nocover"),(0,i.removeAllChildren)(r),r.append(...Array.from({length:e.length},((o,t)=>function(e){const o=document.createElement("img");return o.src=`image/season/${["春","夏","秋","冬"][e.season]}.png`,o.style.position="absolute",o.style.left=`${e.left}px`,o.style.top="15px",o.width=50,o}({left:530-60*[].concat(...e.slice(0,t)).length,season:t})))),r.append(...t.flatMap(((e,t)=>o({score:e,column_index:t})))),r.append(...o({score:20,column_index:-1})),r.append(function(e){const o=document.createElement("img");return o.src="image/始.png",o.style.position="absolute",o.style.left="590px",o.style.top="15px",o.width=50,o}()),r.append(...l(n))},o.drawScoreDisplay=function(e){const o=e.sort(((e,o)=>{const t=["同色無抗行処","無抗行処","同色筆兵無傾","筆兵無傾","同色地心","地心","同色馬弓兵","馬弓兵","同色行行","行行","王","同色獣","獣","同色戦集","戦集","同色助友","助友","同色闇戦之集","闇戦之集","撃皇","皇再来"];return t.indexOf(e)-t.indexOf(o)}));if(o.length>11)throw new Error("too many hands");const[t,c]=[[550,60],[550,60],[550,60],[550,60],[550,60],[550,60],[550,60],[550,60],[550,60],[575,57],[585,53],[595,49]][o.length],d=document.getElementById("score_display");d.classList.remove("nocover"),(0,i.removeAllChildren)(d),document.getElementById("yaku_all").style.left="790px";const u=o.map((e=>n.hand_to_score[e])).reduce(((e,o)=>e+o),0);d.append(...o.flatMap(((e,o)=>{const i=t-c*o,l=s((0,a.toDigitsLinzklar)(n.hand_to_score[e]),{left:i,top:295,width:50});return"同色"===e.slice(0,2)?(l.push((0,r.createHandImage)(e.slice(2),{left:i,top_padding:15})),l.push((0,r.createBapPokImage)({left:i,top_padding:15}))):l.push((0,r.createHandImage)(e,{left:i,top_padding:15})),l}))),d.append(...l(u))}},488:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.normalMessageToKiarArk=o.serializeProf=o.serializeColor=o.serializeCiurl=o.serializeCiurlCount=o.serializeAbsoluteCoord=void 0;const n=t(4974);function r(e){return`${e[1]}${e[0]}`}function i(e){return["無","一","二","三","四","五"][e]}function a(e){return e===n.Color.Huok2?"黒":"赤"}function s(e){return["船","兵","弓","車","虎","馬","筆","巫","将","王"][e]}o.serializeAbsoluteCoord=r,o.serializeCiurlCount=i,o.serializeCiurl=function(e){return i(e.filter((e=>e)).length)},o.serializeColor=a,o.serializeProf=s,o.normalMessageToKiarArk=function(e,o){if("NonTamMove"===e.type){const t=(()=>{if("Tam2"===o.piece_moved)throw new Error("Tam2 was passed to `o.piece_moved` inside `normalMessageToKiarArk` even though `message.type` is `NonTamMove`");return s(o.piece_moved.prof)})();if("FromHand"===e.data.type)return`${a(e.data.color)}${s(e.data.prof)}${r(e.data.dest)}`;if("SrcDst"===e.data.type)return void 0===(null==o?void 0:o.water_ciurl_count)?`${r(e.data.src)}${t}${r(e.data.dest)}無撃裁`:(null==o?void 0:o.water_ciurl_count)<3?`${r(e.data.src)}${t}${r(e.data.dest)}水${i(null==o?void 0:o.water_ciurl_count)}此無`:`${r(e.data.src)}${t}${r(e.data.dest)}水${i(null==o?void 0:o.water_ciurl_count)}`;if("SrcStepDstFinite"===e.data.type)return void 0===(null==o?void 0:o.water_ciurl_count)?`${r(e.data.src)}${t}${r(e.data.step)}${r(e.data.dest)}無撃裁`:(null==o?void 0:o.water_ciurl_count)<3?`${r(e.data.src)}${t}${r(e.data.step)}${r(e.data.dest)}水${i(null==o?void 0:o.water_ciurl_count)}此無`:`${r(e.data.src)}${t}${r(e.data.step)}${r(e.data.dest)}水${i(null==o?void 0:o.water_ciurl_count)}`;throw e.data,new Error("should not reach here")}if("TamMove"===e.type){if("NoStep"===e.stepStyle)return`${r(e.src)}皇[${r(e.firstDest)}]${r(e.secondDest)}`;if("StepsDuringFormer"===e.stepStyle)return`${r(e.src)}皇${r(e.step)}[${r(e.firstDest)}]${r(e.secondDest)}`;if("StepsDuringLatter"===e.stepStyle)return`${r(e.src)}皇[${r(e.firstDest)}]${r(e.step)}${r(e.secondDest)}`;throw e.stepStyle,new Error("should not reach here")}throw new Error("should not reach here")}},5050:(e,o)=>{function t(e){if(e%1!=0)throw new Error("non-integer");if(e>=200){const o=e%100==0?[]:n(e%100);return[...n(Math.floor(e/100)),"num100",...o]}if(e>=100)return["num100",...e%100==0?[]:t(e%100)];if(e<0)return["neg",...t(-e)];if(0==e)return["num00"];const o=e%10==0?[]:["num0"+e%10];return e>=20?[`num0${Math.floor(e/10)}`,"num10",...o]:e>=10?["num10",...o]:o}function n(e){if(e%1!=0)throw new Error("non-integer");if(e>=100)throw new Error("100 or more detected in toDigitsSub");if(e<=0)throw new Error("0 or less detected in toDigitsSub");if(e%10==0){if(e>=20)return[`num0${Math.floor(e/10)}`,"num10"];if(10==e)return["num10"];throw new Error("cannot happen")}{const o="num0"+e%10;return e>=20?[`num0${Math.floor(e/10)}`,o]:e>=10?["num10",o]:[o]}}Object.defineProperty(o,"__esModule",{value:!0}),o.toDigitsLinzklar=void 0,o.toDigitsLinzklar=function(e){return t(e).map((function(e){return{neg:"下",num00:"無",num01:"一",num02:"二",num03:"三",num04:"四",num05:"五",num06:"六",num07:"七",num08:"八",num09:"九",num10:"十",num100:"百"}[e]}))}}},o={};function t(n){var r=o[n];if(void 0!==r)return r.exports;var i=o[n]={exports:{}};return e[n].call(i.exports,i,i.exports,t),i.exports}t(6548),t(2787)})();