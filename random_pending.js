(()=>{"use strict";var e={2392:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.API_ORIGIN=void 0,n.API_ORIGIN="https://serene-reef-96808.herokuapp.com"}},n={};function t(o){var i=n[o];if(void 0!==i)return i.exports;var s=n[o]={exports:{}};return e[o](s,s.exports,t),s.exports}(()=>{const e=t(2392);let n;function o(){(async()=>{let e=await r((e=>e));for(n=e;"LetTheGameBegin"!==e.type;){await new Promise((e=>setTimeout(e,200*(2+Math.random())*.8093)));const t=await i(e.session_token,(e=>e));"Err"!==t.type?(e=t.ret,n=e):(e=await r((e=>e)),n=e)}var t,o,s;t=e.session_token,o=e.is_first_move_my_move,s=e.is_IA_down_for_me,sessionStorage.vs="someone",sessionStorage.session_token=t,sessionStorage.is_first_move_my_move=JSON.stringify(o),sessionStorage.is_IA_down_for_me=JSON.stringify(s),location.href="main.html"})()}async function i(n,t){return await s(location.href.includes("staging")?`${e.API_ORIGIN}/matching/random/poll/staging`:`${e.API_ORIGIN}/matching/random/poll`,{session_token:n},t)}async function s(e,n,t){const o=await fetch(e,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"},keepalive:!0}).then((e=>e.json())).then(t).catch((e=>{console.error("Error:",e)}));if(console.log(o),!o)throw alert("network error!"),new Error("network error!");return o}async function r(n){return await s(location.href.includes("staging")?`${e.API_ORIGIN}/matching/random/entry/staging`:`${e.API_ORIGIN}/matching/random/entry`,{},n)}document.addEventListener("visibilitychange",(()=>{if("hidden"===document.visibilityState){if(void 0!==n){const t=n.session_token;n=void 0,(async()=>{console.log(`trying to cancel ${t}:`);const n=await async function(n,t){return await s(location.href.includes("staging")?`${e.API_ORIGIN}/matching/random/cancel/staging`:`${e.API_ORIGIN}/matching/random/cancel`,{session_token:n},(e=>e))}(t);console.log(`got result ${JSON.stringify(n)}`)})()}}else void 0===n&&o()})),o()})()})();