(()=>{"use strict";var e={2392:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.API_ORIGIN=void 0,o.API_ORIGIN="https://serene-reef-96808.herokuapp.com"}},o={};function n(t){var i=o[t];if(void 0!==i)return i.exports;var r=o[t]={exports:{}};return e[t](r,r.exports,n),r.exports}(()=>{const e=n(2392);let o;async function t(o,n){return await i(location.href.includes("staging")?`${e.API_ORIGIN}/matching/friend/poll/staging`:`${e.API_ORIGIN}/matching/friend/poll`,{session_token:o},n)}async function i(e,o,n){const t=await fetch(e,{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json"},keepalive:!0}).then((e=>e.json())).then(n).catch((e=>{console.error("Error:",e)}));if(console.log(t),!t)throw alert("network error!"),new Error("network error!");return t}(async()=>{const n=await async function(o){return await i(location.href.includes("staging")?`${e.API_ORIGIN}/matching/friend/make_room/staging`:`${e.API_ORIGIN}/matching/friend/make_room`,{},(e=>e))}();o=n;const r=location.href.split("/");r[r.length-1]=`friend_join_room.html?room_id=${n.room_id}&room_key=${n.room_key}`,document.getElementById("url").value=r.join("/");const s=document.getElementById("url-button");s.disabled=!1,s.value=isSecureContext?"URLをコピーする":"全選択";let a=await t(n.session_token,(e=>e));for(;"Ok"!==a.type||"LetTheGameBegin"!==a.ret.type;)await new Promise((e=>setTimeout(e,200*(2+Math.random())*.8093))),a=await t(n.session_token,(e=>e));var c,l,_;c=n.session_token,l=a.ret.is_first_move_my_move,_=a.ret.is_IA_down_for_me,sessionStorage.vs="someone",sessionStorage.session_token=c,sessionStorage.is_first_move_my_move=JSON.stringify(l),sessionStorage.is_IA_down_for_me=JSON.stringify(_),location.href="main.html"})(),document.getElementById("cancel_button").onclick=function(){void 0!==o&&(async()=>{console.log(`trying to cancel ${o.session_token}:`);const n=await async function(o,n){return await i(location.href.includes("staging")?`${e.API_ORIGIN}/matching/friend/delete_room/staging`:`${e.API_ORIGIN}/matching/friend/delete_room`,{session_token:o},(e=>e))}(o.session_token);console.log(`got result ${JSON.stringify(n)}`)})(),location.href="entrance.html"}})()})();